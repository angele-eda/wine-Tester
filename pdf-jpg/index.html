<!doctype html>
<html lang="ko" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>PDF â†’ JPG/PNG | ConvertFiles24</title>
  <meta name="description" content="Convert PDF pages to JPG/PNG locally in your browser. No server upload." />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#0b0f17" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --radius:16px;
      --pad:16px;
      --border:1px solid rgba(255,255,255,.12);
      --blue: 47,109,246;
      --ease: cubic-bezier(.2,.8,.2,1);
      --bg:#0b0f17;
    }
    *{ box-sizing:border-box; }
    html, body{ width:100%; max-width:100%; overflow-x:hidden; }
    body{
      margin:0;
      font-family: Inter, "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", sans-serif;
      background:var(--bg);
      color:#e9eef7;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
    }

    /* entrance */
    body:not(.loaded) .card, body:not(.loaded) .top{ opacity:0; transform: translateY(8px); }
    body.loaded .top{ animation: cfFadeUp .35s var(--ease) both; }
    body.loaded .card{ animation: cfFadeUp .38s var(--ease) both; }
    @keyframes cfFadeUp{ from{opacity:0; transform:translateY(8px);} to{opacity:1; transform:translateY(0);} }
    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; scroll-behavior:auto !important; }
      body:not(.loaded) .card, body:not(.loaded) .top{ opacity:1; transform:none; }
    }

    .wrap{
      max-width:980px;
      width:100%;
      margin:0 auto;
      padding:22px 14px 44px;
      overflow-x: clip;
    }

    .top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin-bottom:14px;
      min-width:0;
    }
    .title{
      margin:0;
      font-weight:900;
      letter-spacing:-0.35px;
      line-height:1.15;
      color:#ffffff;
      font-size:26px;
    }
    .sub{
      margin:8px 0 0;
      color:#a7b3c7;
      font-size:13px;
      line-height:1.45;
    }

    .homeBtn{
      width:100%;
      display:flex; align-items:center; justify-content:center; gap:10px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(47,109,246,.55);
      background:rgba(47,109,246,.18);
      color:#e9eef7;
      font-weight:900;
      cursor:pointer;
      text-decoration:none;
      user-select:none;
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      max-width:420px;
      transition: transform .08s var(--ease), background .12s var(--ease), box-shadow .12s var(--ease);
    }
    .homeBtn:hover{ background:rgba(47,109,246,.24); }
    .homeBtn:active{ transform: scale(.99); }

    .pill{
      width:100%;
      border:1px solid rgba(120, 200, 255, .22);
      background:rgba(120, 200, 255, .06);
      border-radius:999px;
      padding:10px 14px;
      color:#cfe6ff;
      font-size:13px;
      font-weight:900;
      display:flex; align-items:center; justify-content:center; gap:10px;
      min-width:0;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }

    .langRow{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:8px;
      min-width:220px;
      max-width:100%;
      margin-left:auto;
    }
    .langLabel{
      font-size:12px;
      font-weight:900;
      color:#9fb0ca;
      letter-spacing:-0.2px;
      display:flex;
      align-items:center;
      gap:8px;
      opacity:.95;
    }
    .langSelect{
      width:220px;
      max-width:100%;
      padding:12px 12px;
      border-radius:999px;
      border:var(--border);
      background:rgba(255,255,255,.06);
      color:#e9eef7;
      outline:none;
      font-weight:900;
      transition: box-shadow .12s var(--ease), border-color .12s var(--ease), transform .08s var(--ease);
    }
    .langSelect:focus-visible{
      outline:none;
      border-color: rgba(var(--blue), .55);
      box-shadow: 0 0 0 3px rgba(var(--blue),.25);
    }
    option{ background:#0b0f17; color:#e9eef7; }

    .card{
      border:var(--border);
      background:rgba(255,255,255,.03);
      border-radius:var(--radius);
      padding:var(--pad);
      margin-top:12px;
      min-width:0;
      max-width:100%;
      overflow-x: clip;
      will-change: transform, opacity;
    }
    .card h2{
      margin:0 0 10px;
      font-size:15px;
      color:#dbe7ff;
      letter-spacing:-0.2px;
      line-height:1.2;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      min-width:0;
    }
    .row > *{
      flex:1;
      min-width:160px;
      max-width:100%;
      min-width:0;
    }

    .btn{
      appearance:none; border:none; cursor:pointer;
      background:#2f6df6; color:white; font-weight:900;
      padding:12px 14px; border-radius:14px; width:100%;
      font-size:14px;
      letter-spacing: -0.2px;
      user-select:none;
      transition: transform .08s var(--ease), filter .12s var(--ease), box-shadow .12s var(--ease), background .12s var(--ease), border-color .12s var(--ease);
    }
    .btn:hover{ filter: brightness(1.02); }
    .btn:active{ transform: scale(.99); }
    .btn:focus-visible{ outline:none; box-shadow: 0 0 0 3px rgba(var(--blue),.22); }
    .btn:disabled{ opacity:.45; cursor:not-allowed; transform:none; filter:none; box-shadow:none; }

    .btn.secondary{
      background: rgba(47,109,246,.14);
      color:#e9eef7;
      border: 1px solid rgba(47,109,246,.30);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .btn.secondary:hover{
      background: rgba(47,109,246,.18);
      border-color: rgba(47,109,246,.36);
    }

    label{ display:block; font-size:12px; color:#a7b3c7; margin-bottom:6px; }
    select, input[type="number"]{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      color:#e9eef7;
      border:var(--border);
      outline:none;
      font-weight:900;
      max-width:100%;
      transition: box-shadow .12s var(--ease), border-color .12s var(--ease);
    }
    select:focus-visible, input[type="number"]:focus-visible{
      border-color: rgba(var(--blue), .55);
      box-shadow: 0 0 0 3px rgba(var(--blue),.22);
    }

    /* âœ… ë“œë¡­ë°•ìŠ¤ í†µì¼ + ìƒ‰ ë³€í™” */
    .dropbox{
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.22);
      background: rgba(47,109,246,.06);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
      padding:18px 16px;
      min-height: 170px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      transition: background .14s var(--ease), border-color .14s var(--ease), transform .08s var(--ease), box-shadow .14s var(--ease);
      cursor:pointer;
      user-select:none;
      position:relative;
      overflow:hidden;
    }
    .dropbox:hover{
      background: rgba(47,109,246,.08);
    }
    .dropbox.dragover{
      background: rgba(47,109,246,.15);
      border-color: rgba(47,109,246,.55);
      box-shadow: 0 0 0 3px rgba(47,109,246,.18), inset 0 0 0 1px rgba(255,255,255,.08);
    }
    .dropbox.loaded{
      background: rgba(120,200,255,.08); /* âœ… íŒŒì¼ ì˜¬ë¼ì˜¤ë©´ ì‚´ì§ ë‹¤ë¥¸ í†¤ */
      border-color: rgba(120,200,255,.28);
    }
    .dropTitle{
      font-weight:900;
      font-size:18px;
      letter-spacing:-0.2px;
      color:#e9eef7;
      margin-bottom:8px;
    }
    .dropSub{
      color:#9fb0ca;
      font-size:12px;
      line-height:1.5;
    }
    .hint{
      margin-top:10px;
      color:#9fb0ca;
      font-size:12px;
      line-height:1.5;
    }
    .msg{ margin-top:10px; font-size:13px; color:#cfe0ff; }
    .msg.err{ color:#ffb4b4; }
    .msg.ok{ color:#b8ffcc; }
    .meta{
      color:#b7c3d9;
      font-size:13px;
      line-height:1.5;
      word-break:break-word;
      min-width:0;
    }
    .meta b{ color:#e9eef7; }

    .list{
      margin-top:10px;
      display:grid;
      gap:8px;
    }
    .fileItem{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      border-radius:14px;
      padding:10px 12px;
      min-width:0;
    }
    .fileLeft{
      display:flex;
      gap:10px;
      align-items:center;
      min-width:0;
    }
    .fileIcon{
      width:34px;height:34px;
      border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      background: rgba(47,109,246,.14);
      border:1px solid rgba(47,109,246,.25);
      flex:0 0 auto;
    }
    .fileName{
      font-weight:900;
      font-size:13px;
      color:#e9eef7;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      max-width: 52vw;
    }
    .fileInfo{
      font-size:12px;
      color:#9fb0ca;
      margin-top:2px;
    }
    .badge{
      flex:0 0 auto;
      font-size:12px;
      font-weight:900;
      color:#cfe0ff;
      border:1px solid rgba(120,200,255,.22);
      background: rgba(120,200,255,.07);
      border-radius:999px;
      padding:6px 10px;
      white-space:nowrap;
    }

    .footer{
      margin-top:16px;
      color:#94a6c2;
      font-size:12px;
      text-align:center;
    }
    .footer a{ color:#9fb0ca; text-decoration:none; border-bottom:1px dashed rgba(159,176,202,.35); }
    .footer a:hover{ color:#cfe0ff; border-bottom-color:rgba(207,224,255,.6); }

    input[type="file"]{ display:none; }

    /* âœ… ê°„ê²©(ëª¨ë°”ì¼/PC ë‘˜ ë‹¤ ì˜ˆì˜ê²Œ) */
    .sp8{ height:8px; }
    .sp10{ height:10px; }
    .sp12{ height:12px; }
    .sp14{ height:14px; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div style="flex:1; min-width:240px;">
        <h1 class="title" id="page_title">PDF â†’ JPG/PNG</h1>
        <p class="sub" id="page_sub">ì—…ë¡œë“œ â†’ ë³€í™˜ â†’ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ. 100% ë¡œì»¬ ì²˜ë¦¬.</p>

        <div style="margin-top:10px;">
          <a class="homeBtn" href="/" id="home_btn">ğŸ  í™ˆìœ¼ë¡œ</a>
        </div>

        <div style="margin-top:10px;">
          <div class="pill">ğŸ”’ <span id="local_processing">ë¡œì»¬ ì²˜ë¦¬ â€” ì„œë²„ ì—…ë¡œë“œ ì—†ìŒ</span></div>
        </div>
      </div>

      <div class="langRow">
        <div class="langLabel">ğŸŒ <span id="lang_label">ì–¸ì–´</span></div>
        <select class="langSelect" id="langSelect" aria-label="Language">
          <option value="ko">í•œêµ­ì–´</option>
          <option value="en">Global (English)</option>
          <option value="es">EspaÃ±ol</option>
          <option value="ja">æ—¥æœ¬èª</option>
        </select>
      </div>
    </div>

    <div class="card">
      <h2 id="h_file">PDF ì—…ë¡œë“œ</h2>

      <!-- âœ… íŒŒì¼ ì„ íƒ(ì¤‘ë³µ ë²„íŠ¼/ì¤‘ë³µ input ì œê±°) -->
      <input id="pdfInput" type="file" accept="application/pdf" />

      <!-- âœ… ë“œë¡­ë°•ìŠ¤ í†µì¼ -->
      <div class="dropbox" id="dropbox" role="button" tabindex="0" aria-label="PDF dropzone">
        <div>
          <div class="dropTitle" id="drop_title">ì—¬ê¸°ì— PDFë¥¼ ëŒì–´ë‹¤ ë†“ê±°ë‚˜ íƒ­í•´ì„œ ì—…ë¡œë“œ</div>
          <div class="dropSub" id="drop_sub">íŒ: ê° í˜ì´ì§€ë¥¼ ì´ë¯¸ì§€ë¡œ ë‚´ë ¤ë°›ì„ ìˆ˜ ìˆì–´ìš”.</div>
        </div>
      </div>

      <!-- âœ… ë¹„ìš°ê¸°(ë“œë¡­ë°•ìŠ¤ ë°”ë¡œ ì•„ë˜) -->
      <div class="sp10"></div>
      <div class="row">
        <button class="btn secondary" id="pickBtn" type="button">ğŸ“„ PDF ì„ íƒ</button>
        <button class="btn secondary" id="clearBtn" type="button" disabled>ğŸ§¹ ë¹„ìš°ê¸°</button>
      </div>

      <div class="list" id="fileList" style="display:none;"></div>
      <div class="msg" id="msg"></div>
    </div>

    <div class="card">
      <h2 id="h_convert">ë³€í™˜</h2>

      <div class="row">
        <div>
          <label id="lbl_format">í˜•ì‹</label>
          <select id="outFormat">
            <option value="image/jpeg" selected>JPG</option>
            <option value="image/png">PNG</option>
            <option value="image/webp">WebP</option>
          </select>
        </div>
        <div>
          <label id="lbl_quality">í’ˆì§ˆ</label>
          <select id="quality">
            <option value="0.95">Max (0.95)</option>
            <option value="0.90" selected>High (0.90)</option>
            <option value="0.80">Normal (0.80)</option>
            <option value="0.70">Small (0.70)</option>
          </select>
        </div>
      </div>

      <div class="hint" id="convert_hint">ì—¬ëŸ¬ í˜ì´ì§€ë©´ ZIPìœ¼ë¡œ ë¬¶ì–´ì„œ ë‚´ë ¤ë°›ìŠµë‹ˆë‹¤.</div>

      <div class="sp12"></div>
      <button class="btn" id="convertBtn" type="button" disabled>ğŸ§© ë³€í™˜ í›„ ë‹¤ìš´ë¡œë“œ</button>

      <div class="sp10"></div>
      <div class="meta" id="meta"><b>ìƒíƒœ</b><br/>PDFë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.</div>
    </div>

    <div class="footer">
      Â© <span id="year"></span> ConvertFiles24 Â·
      <a href="/privacy.html">Privacy</a> Â·
      <a href="/terms.html">Terms</a>
    </div>
  </div>

  <!-- âœ… PDF.js + JSZip (ë³€í™˜ ì‹¤íŒ¨ ì›ì¸ ëŒ€ë¶€ë¶„: pdf.js ë¯¸ë¡œë”©) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.7.76/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
  (() => {
    "use strict";
    const $ = (id)=>document.getElementById(id);

    $("year").textContent = new Date().getFullYear();
    requestAnimationFrame(()=> document.body.classList.add("loaded"));

    // ========== i18n (ê°„ë‹¨ ìœ ì§€) ==========
    const STR = {
      ko: {
        page_title: "PDF â†’ JPG/PNG",
        page_sub: "ì—…ë¡œë“œ â†’ ë³€í™˜ â†’ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ. 100% ë¡œì»¬ ì²˜ë¦¬.",
        home: "ğŸ  í™ˆìœ¼ë¡œ",
        local: "ë¡œì»¬ ì²˜ë¦¬ â€” ì„œë²„ ì—…ë¡œë“œ ì—†ìŒ",
        lang_label: "ì–¸ì–´",

        h_file: "PDF ì—…ë¡œë“œ",
        drop_title: "ì—¬ê¸°ì— PDFë¥¼ ëŒì–´ë‹¤ ë†“ê±°ë‚˜ íƒ­í•´ì„œ ì—…ë¡œë“œ",
        drop_sub: "íŒ: ê° í˜ì´ì§€ë¥¼ ì´ë¯¸ì§€ë¡œ ë‚´ë ¤ë°›ì„ ìˆ˜ ìˆì–´ìš”.",
        pick: "ğŸ“„ PDF ì„ íƒ",
        clear: "ğŸ§¹ ë¹„ìš°ê¸°",

        h_convert: "ë³€í™˜",
        format: "í˜•ì‹",
        quality: "í’ˆì§ˆ",
        convert_hint: "ì—¬ëŸ¬ í˜ì´ì§€ë©´ ZIPìœ¼ë¡œ ë¬¶ì–´ì„œ ë‚´ë ¤ë°›ìŠµë‹ˆë‹¤.",
        convert: "ğŸ§© ë³€í™˜ í›„ ë‹¤ìš´ë¡œë“œ",

        msg_ready: "ì¤€ë¹„ ì™„ë£Œ! ë³€í™˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.",
        msg_cleared: "ì´ˆê¸°í™” ì™„ë£Œ.",
        msg_bad: "PDFë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆì–´ìš”.",
        msg_fail: "ë³€í™˜ ì‹¤íŒ¨: ",
        msg_busy: "ë³€í™˜ ì¤‘â€¦ (í˜ì´ì§€ê°€ ë§ìœ¼ë©´ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆì–´ìš”)",
        meta_none: "<b>ìƒíƒœ</b><br/>PDFë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.",
        meta_file: (name, sizeMB)=> `<b>PDF</b><br/>íŒŒì¼ëª…: ${escapeHtml(name)}<br/>í¬ê¸°: ${sizeMB}MB`
      },
      en: {
        page_title: "PDF â†’ JPG/PNG",
        page_sub: "Upload â†’ convert â†’ download images. 100% local processing.",
        home: "ğŸ  Home",
        local: "Processed locally â€” no server upload",
        lang_label: "Language",

        h_file: "Upload PDF",
        drop_title: "Drop PDF here or tap to upload",
        drop_sub: "Tip: Download each page as an image.",
        pick: "ğŸ“„ Choose PDF",
        clear: "ğŸ§¹ Clear",

        h_convert: "Convert",
        format: "Format",
        quality: "Quality",
        convert_hint: "Multi-page PDFs will be downloaded as a ZIP.",
        convert: "ğŸ§© Convert & Download",

        msg_ready: "Ready. Press convert.",
        msg_cleared: "Cleared.",
        msg_bad: "Only PDF files are supported.",
        msg_fail: "Failed: ",
        msg_busy: "Convertingâ€¦",
        meta_none: "<b>Status</b><br/>Select a PDF first.",
        meta_file: (name, sizeMB)=> `<b>PDF</b><br/>Name: ${escapeHtml(name)}<br/>Size: ${sizeMB}MB`
      },
      es: {
        page_title: "PDF â†’ JPG/PNG",
        page_sub: "Sube â†’ convierte â†’ descarga imÃ¡genes. 100% local.",
        home: "ğŸ  Inicio",
        local: "Procesado local â€” sin servidor",
        lang_label: "Idioma",

        h_file: "Subir PDF",
        drop_title: "Suelta un PDF aquÃ­ o toca para subir",
        drop_sub: "Consejo: descarga cada pÃ¡gina como imagen.",
        pick: "ğŸ“„ Elegir PDF",
        clear: "ğŸ§¹ Vaciar",

        h_convert: "Convertir",
        format: "Formato",
        quality: "Calidad",
        convert_hint: "Si hay varias pÃ¡ginas, se descarga como ZIP.",
        convert: "ğŸ§© Convertir y descargar",

        msg_ready: "Listo. Pulsa convertir.",
        msg_cleared: "Listo.",
        msg_bad: "Solo se admite PDF.",
        msg_fail: "Error: ",
        msg_busy: "Convirtiendoâ€¦",
        meta_none: "<b>Estado</b><br/>Selecciona un PDF.",
        meta_file: (name, sizeMB)=> `<b>PDF</b><br/>Nombre: ${escapeHtml(name)}<br/>TamaÃ±o: ${sizeMB}MB`
      },
      ja: {
        page_title: "PDF â†’ JPG/PNG",
        page_sub: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ å¤‰æ› â†’ ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€‚100% ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã€‚",
        home: "ğŸ  ãƒ›ãƒ¼ãƒ ",
        local: "ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç† â€” ã‚µãƒ¼ãƒãƒ¼ãªã—",
        lang_label: "è¨€èª",

        h_file: "PDF ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
        drop_title: "ã“ã“ã«PDFã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠ",
        drop_sub: "ãƒ’ãƒ³ãƒˆï¼šå„ãƒšãƒ¼ã‚¸ã‚’ç”»åƒã§ä¿å­˜ã§ãã¾ã™ã€‚",
        pick: "ğŸ“„ PDFã‚’é¸æŠ",
        clear: "ğŸ§¹ ã‚¯ãƒªã‚¢",

        h_convert: "å¤‰æ›",
        format: "å½¢å¼",
        quality: "å“è³ª",
        convert_hint: "è¤‡æ•°ãƒšãƒ¼ã‚¸ã¯ZIPã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚",
        convert: "ğŸ§© å¤‰æ›ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",

        msg_ready: "æº–å‚™OKã€‚å¤‰æ›ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚",
        msg_cleared: "åˆæœŸåŒ–ã—ã¾ã—ãŸã€‚",
        msg_bad: "PDFã®ã¿å¯¾å¿œã§ã™ã€‚",
        msg_fail: "å¤±æ•—: ",
        msg_busy: "å¤‰æ›ä¸­â€¦",
        meta_none: "<b>çŠ¶æ…‹</b><br/>PDFã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚",
        meta_file: (name, sizeMB)=> `<b>PDF</b><br/>åå‰: ${escapeHtml(name)}<br/>ã‚µã‚¤ã‚º: ${sizeMB}MB`
      }
    };

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (m)=>({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[m]));
    }

    function getQueryLang(){
      try{
        const u = new URL(location.href);
        const q = (u.searchParams.get("lang")||"").toLowerCase();
        if(q && STR[q]) return q;
      }catch(e){}
      return null;
    }

    function detectLang(){
      const q = getQueryLang();
      if(q) return q;
      const saved = localStorage.getItem("cf24_lang");
      if(saved && STR[saved]) return saved;
      const nav = (navigator.language || "").toLowerCase();
      if(nav.startsWith("ko")) return "ko";
      if(nav.startsWith("ja")) return "ja";
      if(nav.startsWith("es")) return "es";
      return "en";
    }

    let LANG = detectLang();
    const t = ()=> STR[LANG] || STR.en;

    function setLang(lang){
      if(!STR[lang]) lang = "en";
      LANG = lang;
      localStorage.setItem("cf24_lang", lang);
      $("langSelect").value = lang;
      document.documentElement.lang = lang;

      $("page_title").textContent = t().page_title;
      $("page_sub").textContent = t().page_sub;
      $("home_btn").textContent = t().home;
      $("local_processing").textContent = t().local;
      $("lang_label").textContent = t().lang_label;

      $("h_file").textContent = t().h_file;
      $("drop_title").textContent = t().drop_title;
      $("drop_sub").textContent = t().drop_sub;
      $("pickBtn").textContent = t().pick;
      $("clearBtn").textContent = t().clear;

      $("h_convert").textContent = t().h_convert;
      $("lbl_format").textContent = t().format;
      $("lbl_quality").textContent = t().quality;
      $("convert_hint").textContent = t().convert_hint;
      $("convertBtn").textContent = t().convert;

      if(!state.file) $("meta").innerHTML = t().meta_none;
    }

    $("langSelect").addEventListener("change", e=> setLang(e.target.value));

    // ========== state ==========
    const state = {
      file: null,
      fileName: "",
      busy: false
    };

    // ========== UI refs ==========
    const pdfInput = $("pdfInput");
    const dropbox  = $("dropbox");
    const pickBtn  = $("pickBtn");
    const clearBtn = $("clearBtn");
    const convertBtn = $("convertBtn");
    const msgEl = $("msg");
    const fileList = $("fileList");
    const metaEl = $("meta");

    const outFormatEl = $("outFormat");
    const qualityEl = $("quality");

    function setMsg(text, cls){
      msgEl.textContent = text || "";
      msgEl.className = "msg " + (cls || "");
    }

    function setBusy(b){
      state.busy = b;
      pickBtn.disabled = b;
      clearBtn.disabled = b || !state.file;
      convertBtn.disabled = b || !state.file;
      dropbox.style.opacity = b ? ".7" : "1";
    }

    function bytesToMB(b){
      return (b / (1024*1024)).toFixed(2);
    }

    function renderFileCard(){
      if(!state.file){
        fileList.style.display = "none";
        dropbox.classList.remove("loaded");
        metaEl.innerHTML = t().meta_none;
        return;
      }
      dropbox.classList.add("loaded");
      fileList.style.display = "grid";
      fileList.innerHTML = `
        <div class="fileItem">
          <div class="fileLeft">
            <div class="fileIcon" aria-hidden="true">ğŸ“„</div>
            <div style="min-width:0;">
              <div class="fileName">${escapeHtml(state.fileName)}</div>
              <div class="fileInfo">${bytesToMB(state.file.size)} MB</div>
            </div>
          </div>
          <div class="badge">PDF</div>
        </div>
      `;
      metaEl.innerHTML = t().meta_file(state.fileName, bytesToMB(state.file.size));
    }

    function resetAll(){
      state.file = null;
      state.fileName = "";
      pdfInput.value = "";
      setMsg(t().msg_cleared, "ok");
      renderFileCard();
      setBusy(false);
    }

    function acceptFile(file){
      if(!file) return;
      const isPdf = (file.type === "application/pdf") || (String(file.name||"").toLowerCase().endsWith(".pdf"));
      if(!isPdf){
        setMsg(t().msg_bad, "err");
        return;
      }
      state.file = file;
      state.fileName = file.name || "document.pdf";
      setMsg(t().msg_ready, "ok");
      renderFileCard();
      setBusy(false);
    }

    // ========== drop events ==========
    function prevent(e){ e.preventDefault(); e.stopPropagation(); }

    ["dragenter","dragover"].forEach(ev=>{
      dropbox.addEventListener(ev, (e)=>{
        prevent(e);
        dropbox.classList.add("dragover");
      });
    });
    ["dragleave","drop"].forEach(ev=>{
      dropbox.addEventListener(ev, (e)=>{
        prevent(e);
        dropbox.classList.remove("dragover");
      });
    });
    dropbox.addEventListener("drop", (e)=>{
      const file = e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files[0];
      acceptFile(file);
    });

    // click / key open file
    function openPicker(){ if(!state.busy) pdfInput.click(); }
    dropbox.addEventListener("click", openPicker);
    dropbox.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " "){ e.preventDefault(); openPicker(); }
    });
    pickBtn.addEventListener("click", openPicker);
    pdfInput.addEventListener("change", ()=> acceptFile(pdfInput.files && pdfInput.files[0]));

    clearBtn.addEventListener("click", resetAll);

    // quality disabled for PNG
    outFormatEl.addEventListener("change", ()=>{
      const mime = outFormatEl.value;
      const disableQ = (mime === "image/png");
      qualityEl.disabled = disableQ;
      qualityEl.style.opacity = disableQ ? ".6" : "1";
    });

    // ========== convert engine ==========
    // pdf.js worker
    function ensurePdfjsWorker(){
      // pdfjsLib is global from CDN
      if(window.pdfjsLib && window.pdfjsLib.GlobalWorkerOptions){
        // use same CDN version for worker
        window.pdfjsLib.GlobalWorkerOptions.workerSrc =
          "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.7.76/pdf.worker.min.js";
      }
    }

    function downloadBlob(blob, filename){
      const a = document.createElement("a");
      const url = URL.createObjectURL(blob);
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 1500);
    }

    function safeBaseName(name){
      const base = (name || "pdf").replace(/\.[^.]+$/, "");
      return base.replace(/[\\/:*?"<>|]+/g, "_");
    }

    async function fileToArrayBuffer(file){
      return await file.arrayBuffer();
    }

    async function renderPageToImage(pdf, pageNum, mime, quality){
      const page = await pdf.getPage(pageNum);

      // scale: ëª¨ë°”ì¼ë„ ì„ ëª…í•˜ê²Œ (ë„ˆë¬´ ë¬´ê±°ì›Œì§€ì§€ ì•Šê²Œ ì ë‹¹íˆ)
      const viewport = page.getViewport({ scale: 2.0 });
      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d", { alpha: mime !== "image/jpeg" });
      canvas.width = Math.floor(viewport.width);
      canvas.height = Math.floor(viewport.height);

      // JPGëŠ” ë°°ê²½ í°ìƒ‰
      if(mime === "image/jpeg"){
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(0,0,canvas.width,canvas.height);
      }

      await page.render({ canvasContext: ctx, viewport }).promise;

      const blob = await new Promise((resolve, reject)=>{
        if(mime === "image/png"){
          canvas.toBlob(b=> b ? resolve(b) : reject(new Error("toBlob failed")), "image/png");
        }else if(mime === "image/webp"){
          canvas.toBlob(b=> b ? resolve(b) : reject(new Error("toBlob failed")), "image/webp", quality);
        }else{
          canvas.toBlob(b=> b ? resolve(b) : reject(new Error("toBlob failed")), "image/jpeg", quality);
        }
      });

      return blob;
    }

    async function convertPdf(){
      if(!state.file) return;

      try{
        ensurePdfjsWorker();
        if(!window.pdfjsLib) throw new Error("PDF engine not loaded (pdf.js).");

        setBusy(true);
        setMsg(t().msg_busy, "");

        const mime = outFormatEl.value;
        const q = parseFloat(qualityEl.value || "0.9");
        const ext = (mime === "image/png") ? "png" : (mime === "image/webp" ? "webp" : "jpg");

        const buf = await fileToArrayBuffer(state.file);
        const loadingTask = window.pdfjsLib.getDocument({ data: buf });
        const pdf = await loadingTask.promise;

        const total = pdf.numPages || 1;
        const base = safeBaseName(state.fileName);
        const stamp = new Date().toISOString().replace(/[:.]/g,"-");

        if(total === 1){
          const blob = await renderPageToImage(pdf, 1, mime, q);
          downloadBlob(blob, `${base}_${stamp}.${ext}`);
          setMsg("âœ… ì™„ë£Œ", "ok");
          setBusy(false);
          return;
        }

        // multi-page => zip
        const zip = new JSZip();
        for(let p=1; p<=total; p++){
          setMsg(`${t().msg_busy} (${p}/${total})`, "");
          const blob = await renderPageToImage(pdf, p, mime, q);
          const arr = await blob.arrayBuffer();
          zip.file(`${base}_p${String(p).padStart(3,"0")}.${ext}`, arr);
        }

        const zipBlob = await zip.generateAsync({ type:"blob", compression:"DEFLATE", compressionOptions:{ level: 6 } });
        downloadBlob(zipBlob, `${base}_${stamp}_${ext}.zip`);

        setMsg("âœ… ì™„ë£Œ", "ok");
        setBusy(false);
      }catch(err){
        setBusy(false);
        setMsg(t().msg_fail + (err && err.message ? err.message : "unknown"), "err");
      }
    }

    convertBtn.addEventListener("click", convertPdf);

    // init
    setLang(LANG);
    renderFileCard();
    outFormatEl.dispatchEvent(new Event("change"));
    setBusy(false);
  })();
  </script>
</body>
</html>