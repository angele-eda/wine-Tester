<!doctype html>
<html lang="en" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Split PDF | ConvertFiles24</title>
  <meta name="description" content="Split PDF pages online. Extract page ranges and download instantly. 100% local processing (no server upload)." />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#0b0f17" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">

  <!-- PDF-lib (local in browser) -->
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <!-- JSZip (for split all -> zip) -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <style>
    :root{
      --radius:16px;
      --pad:16px;
      --border:1px solid rgba(255,255,255,.12);
      --blue: 47,109,246;
      --ease: cubic-bezier(.2,.8,.2,1);

      --softBlueBg: rgba(120, 200, 255, .06);
      --softBlueBd: rgba(120, 200, 255, .22);
      --softBlueTx: #cfe6ff;
      --softBlueHi: rgba(120, 200, 255, .12);
    }
    *{ box-sizing:border-box; }
    html, body{ width:100%; max-width:100%; overflow-x:hidden; }
    body{
      margin:0;
      font-family: Inter, "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", sans-serif;
      background:#0b0f17;
      color:#e9eef7;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
    }

    body:not(.loaded) .card, body:not(.loaded) .top{ opacity:0; transform: translateY(8px); }
    body.loaded .top{ animation: cfFadeUp .35s var(--ease) both; }
    body.loaded .card{ animation: cfFadeUp .38s var(--ease) both; }
    @keyframes cfFadeUp{ from{opacity:0; transform:translateY(8px);} to{opacity:1; transform:translateY(0);} }
    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; scroll-behavior:auto !important; }
      body:not(.loaded) .card, body:not(.loaded) .top{ opacity:1; transform:none; }
    }

    .wrap{
      max-width:980px;
      width:100%;
      margin:0 auto;
      padding:22px 14px 44px;
      overflow-x: clip;
    }

    .top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin-bottom:14px;
      min-width:0;
    }

    .title{
      margin:0;
      font-weight:900;
      letter-spacing:-0.35px;
      line-height:1.15;
      color:#ffffff;
      font-size:22px;
    }
    .sub{
      margin:8px 0 0;
      color:#a7b3c7;
      font-size:13px;
      line-height:1.45;
    }

    .homeBtn{
      width:100%;
      display:flex; align-items:center; justify-content:center; gap:10px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(47,109,246,.55);
      background:rgba(47,109,246,.18);
      color:#e9eef7;
      font-weight:900;
      cursor:pointer;
      text-decoration:none;
      user-select:none;
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      max-width:380px;
      transition: transform .08s var(--ease), background .12s var(--ease), box-shadow .12s var(--ease);
    }
    .homeBtn:hover{ background:rgba(47,109,246,.24); }
    .homeBtn:active{ transform: scale(.99); }
    .homeBtn:focus-visible{
      outline:none;
      box-shadow: 0 0 0 3px rgba(var(--blue),.35), 0 10px 24px rgba(0,0,0,.25);
    }

    .langRow{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:8px;
      min-width:220px;
      max-width:100%;
      margin-left:auto;
    }
    .langLabel{
      font-size:12px;
      font-weight:900;
      color:#9fb0ca;
      letter-spacing:-0.2px;
      display:flex;
      align-items:center;
      gap:8px;
      opacity:.95;
    }
    .langSelect{
      width:220px;
      max-width:100%;
      padding:12px 12px;
      border-radius:999px;
      border:var(--border);
      background:rgba(255,255,255,.06);
      color:#e9eef7;
      outline:none;
      font-weight:900;
      transition: box-shadow .12s var(--ease), border-color .12s var(--ease), transform .08s var(--ease);
    }
    .langSelect:focus-visible{
      outline:none;
      border-color: rgba(var(--blue), .55);
      box-shadow: 0 0 0 3px rgba(var(--blue),.25);
    }
    option{ background:#0b0f17; color:#e9eef7; }

    .pill{
      width:100%;
      border:1px solid rgba(120, 200, 255, .22);
      background:rgba(120, 200, 255, .06);
      border-radius:999px;
      padding:10px 14px;
      color:#cfe6ff;
      font-size:13px;
      font-weight:900;
      display:flex; align-items:center; justify-content:center; gap:10px;
      min-width:0;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }

    .card{
      border:var(--border);
      background:rgba(255,255,255,.03);
      border-radius:var(--radius);
      padding:var(--pad);
      margin-top:12px;
      min-width:0;
      max-width:100%;
      overflow-x: clip;
      will-change: transform, opacity;
    }
    .card h2{ margin:0 0 10px; font-size:15px; color:#dbe7ff; letter-spacing:-0.2px; }

    .drop{
      border:1px dashed rgba(255,255,255,.18);
      border-radius:14px; padding:18px;
      background:rgba(255,255,255,.02);
      text-align:center;
      cursor:pointer;
      user-select:none;
      transition: background .15s var(--ease), border-color .15s var(--ease), box-shadow .15s var(--ease), transform .05s var(--ease);
      position: relative;
      min-height: 160px;
      display:flex; align-items:center; justify-content:center;
      max-width:100%;
      overflow:hidden;
    }
    .drop.drag{
      background:rgba(106,169,255,.12);
      border-color:rgba(106,169,255,.45);
      box-shadow: 0 0 0 3px rgba(106,169,255,.10) inset;
    }
    .drop:active{ transform: scale(0.998); }
    .drop:focus-visible{ outline:none; box-shadow: 0 0 0 3px rgba(var(--blue),.25); }

    /* âœ… active ëŠë‚Œ */
    .drop.active{
      border-color: rgba(47,109,246,.55);
      background: rgba(47,109,246,.07);
      box-shadow: 0 0 0 1px rgba(47,109,246,.18), 0 18px 40px rgba(0,0,0,.35);
    }

    /* âœ… í…ìŠ¤íŠ¸ ê²¹ì¹¨ ë°©ì§€: ë°°ì§€ ëœ° ë•Œ ì˜¤ë¥¸ìª½ ì—¬ë°± ìë™ í™•ë³´ */
    .dropInner{ width:100%; }
    .drop.hasBadge .dropInner{ padding-right: 86px; }

    /* âœ… ìš°ì¸¡ ìƒë‹¨ ë°°ì§€(í˜ì´ì§€ ìˆ˜) â€” ë” ì‘ê²Œ */
    .dropBadge{
      position:absolute;
      top:10px;
      right:10px;
      display:none;
      align-items:center;
      gap:6px;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid rgba(46, 204, 113, .32);
      background: rgba(46, 204, 113, .12);
      box-shadow: 0 10px 22px rgba(0,0,0,.28);
      color:#e9eef7;
      font-weight:900;
      letter-spacing:-0.2px;
      user-select:none;
      pointer-events:none;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transform: translateZ(0);
    }
    .dropBadge .tick{
      width:16px;
      height:16px;
      border-radius:6px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      background: rgba(46, 204, 113, .92);
      color:#0b0f17;
      font-weight:1000;
      font-size:12px;
      line-height:1;
      box-shadow: 0 0 0 1px rgba(0,0,0,.10) inset;
    }
    .dropBadge .txt{ font-size:11px; font-weight:900; opacity:.95; }

    .dropEmoji{
      font-size:42px;
      line-height:1;
      margin:10px 0 8px;
      filter: drop-shadow(0 10px 22px rgba(0,0,0,.28));
    }

    .hint{ margin-top:10px; color:#9fb0ca; font-size:12px; line-height:1.5; }
    .small{ color:#a7b3c7; font-size:12px; line-height:1.5; }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      min-width:0;
    }
    .row > *{ flex:1; min-width:160px; max-width:100%; min-width:0; }

    .btn{
      appearance:none; border:none; cursor:pointer;
      background:#2f6df6; color:white; font-weight:900;
      padding:12px 14px; border-radius:14px; width:100%;
      font-size:14px;
      letter-spacing: -0.2px;
      user-select:none;
      transition: transform .08s var(--ease), filter .12s var(--ease), box-shadow .12s var(--ease), background .12s var(--ease);
    }
    .btn.secondary{
      background: var(--softBlueBg);
      border: 1px solid var(--softBlueBd);
      color: var(--softBlueTx);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }
    .btn.secondary:hover{ background: var(--softBlueHi); }

    .btn:hover{ filter: brightness(1.03); }
    .btn:active{ transform: scale(.99); }
    .btn:focus-visible{ outline:none; box-shadow: 0 0 0 3px rgba(var(--blue),.25); }

    .btn:disabled{
      opacity:1;
      cursor:not-allowed;
      transform:none;
      box-shadow:none;
      filter: saturate(.7);
      background: linear-gradient(180deg, rgba(47,109,246,.40), rgba(47,109,246,.30));
      color:#ffffff;
    }
    .btn.secondary:disabled{
      filter: none;
      background: rgba(120, 200, 255, .05);
      border: 1px solid rgba(120, 200, 255, .16);
      color: rgba(207, 230, 255, .70);
      box-shadow:none;
    }

    input[type="file"]{ display:none; }
    label{ display:block; font-size:12px; color:#a7b3c7; margin-bottom:6px; }

    input[type="text"]{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      color:#e9eef7;
      border:var(--border);
      outline:none;
      font-weight:900;
      transition: box-shadow .12s var(--ease), border-color .12s var(--ease);
    }
    input[type="text"]:focus-visible{
      border-color: rgba(var(--blue), .55);
      box-shadow: 0 0 0 3px rgba(var(--blue),.22);
    }

    .msg{ margin-top:10px; font-size:13px; color:#cfe0ff; }
    .msg.err{ color:#ffb4b4; }
    .msg.ok{ color:#b8ffcc; }

    .meta{
      color:#b7c3d9;
      font-size:13px;
      line-height:1.5;
      word-break:break-word;
      min-width:0;
    }
    .meta b{ color:#e9eef7; }

    /* âœ… ZIP í† ê¸€(ì²´í¬) */
    .chk{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(47,109,246,.22);
      background: rgba(47,109,246,.08);
      color:#d7e4ff;
      font-weight:900;
      user-select:none;
      cursor:pointer;
      transition: background .12s var(--ease), border-color .12s var(--ease);
    }
    .chk:hover{ background: rgba(47,109,246,.12); border-color: rgba(47,109,246,.30); }
    .chk input{ width:18px; height:18px; }

    /* âœ… Progress bar (ë²„íŠ¼ ë°”ë¡œ ìœ„) */
    .progressWrap{
      width:100%;
      height:8px;
      background: rgba(255,255,255,.08);
      border-radius: 999px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      display:none;
    }
    .progressBar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(47,109,246,.85), rgba(46,204,113,.70));
      transition: width .18s ease;
    }
    .progressText{
      margin-top:8px;
      font-size:12px;
      color:#bcd1ff;
      font-weight:900;
      letter-spacing:-0.2px;
      display:none;
    }

    .footer{
      margin-top:16px;
      color:#94a6c2;
      font-size:12px;
      text-align:center;
    }
    .footer a{ color:#9fb0ca; text-decoration:none; border-bottom:1px dashed rgba(159,176,202,.35); }
    .footer a:hover{ color:#cfe0ff; border-bottom-color:rgba(207,224,255,.6); }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div style="flex:1; min-width:240px;">
        <h1 class="title" id="page_title">Split PDF</h1>
        <p class="sub" id="page_sub">Upload â†’ choose pages â†’ download. 100% local processing.</p>

        <div style="margin-top:10px;">
          <a class="homeBtn" href="/" id="home_btn">ğŸ  Home</a>
        </div>

        <div style="margin-top:10px;">
          <div class="pill">ğŸ”’ <span id="local_processing">Processed locally â€” no server upload</span></div>
        </div>
      </div>

      <div class="langRow">
        <div class="langLabel">ğŸŒ <span id="lang_label">Language</span></div>
        <select class="langSelect" id="langSelect" aria-label="Language">
          <option value="en">Global (English)</option>
          <option value="ko">í•œêµ­ì–´</option>
          <option value="es">EspaÃ±ol</option>
          <option value="ja">æ—¥æœ¬èª</option>
        </select>
      </div>
    </div>

    <div class="card">
      <h2 id="h_step1">Upload PDF</h2>

      <div class="row">
        <button class="btn secondary" id="pickBtn" type="button">ğŸ“„ Choose PDF</button>
        <button class="btn secondary" id="clearBtn" type="button" disabled>ğŸ§¹ Clear</button>
      </div>

      <div style="height:10px;"></div>

      <div class="drop" id="drop" role="button" tabindex="0" aria-label="Upload PDF">
        <div class="dropBadge" id="dropBadge">
          <span class="tick">âœ“</span>
          <span class="txt" id="dropBadgeText">0</span>
        </div>

        <div class="dropInner">
          <div style="font-weight:900; margin-bottom:6px;" id="drop_title">Drop PDF here<br/>or tap to upload</div>
          <div class="dropEmoji" aria-hidden="true">ğŸ“„</div>
          <div class="hint" id="drop_hint">Tip: Large PDFs may take a moment on mobile.</div>
        </div>
      </div>

      <div class="msg" id="msg"></div>
    </div>

    <div class="card">
      <h2 id="h_step2">Pages</h2>

      <div class="row">
        <div>
          <label id="lbl_range">Pages to extract</label>
          <input id="range" type="text" placeholder="e.g. 1-3, 5, 8-10" disabled>
          <div class="small" id="range_hint">Use 1-based pages. Supports commas and ranges.</div>
        </div>
      </div>

      <div style="height:10px;"></div>

      <div class="row">
        <label class="chk" id="zipLabel" title="Split all pages to individual PDFs and download as ZIP">
          <input type="checkbox" id="zipMode" disabled>
          <span id="zip_text">Split ALL pages â†’ ZIP</span>
        </label>
      </div>

      <div style="height:12px;"></div>

      <div class="progressWrap" id="progressWrap" aria-hidden="true">
        <div class="progressBar" id="progressBar"></div>
      </div>
      <div class="progressText" id="progressText"></div>

      <div style="height:10px;"></div>

      <div class="row">
        <button class="btn" id="downloadBtn" type="button" disabled>â¬‡ï¸ Download extracted PDF</button>
      </div>

      <div style="height:12px;"></div>
      <div class="meta" id="meta"><b>Status</b><br/>Upload a PDF to see page count.</div>
    </div>

    <div class="footer">
      Â© <span id="year"></span> ConvertFiles24 Â·
      <a href="/privacy.html">Privacy</a> Â·
      <a href="/terms.html">Terms</a>
    </div>
  </div>

  <input id="pickInput" type="file" accept="application/pdf">

<script>
(() => {
  "use strict";
  const $ = (id)=>document.getElementById(id);
  $("year").textContent = new Date().getFullYear();
  requestAnimationFrame(()=> document.body.classList.add("loaded"));

  const STR = {
    en:{
      page_title:"Split PDF",
      page_sub:"Upload â†’ choose pages â†’ download. 100% local processing.",
      home:"ğŸ  Home",
      local:"Processed locally â€” no server upload",
      lang_label:"Language",
      h1:"Upload PDF",
      pick:"ğŸ“„ Choose PDF",
      clear:"ğŸ§¹ Clear",
      drop_title:"Drop PDF here<br/>or tap to upload",
      drop_hint:"Tip: Large PDFs may take a moment on mobile.",
      h2:"Pages",
      lbl_range:"Pages to extract",
      range_ph:"e.g. 1-3, 5, 8-10",
      range_hint:"Use 1-based pages. Supports commas and ranges.",
      zip:"Split ALL pages â†’ ZIP",
      zip_hint_on:"ZIP mode is ON. All pages will be split into separate PDFs.",
      dl:"â¬‡ï¸ Download extracted PDF",
      dl_zip:"â¬‡ï¸ Download ZIP (all pages)",
      meta_idle:"<b>Status</b><br/>Upload a PDF to see page count.",
      meta_loaded:(name,p)=>`<b>PDF</b><br/>${escapeHtml(name)}<br/><b>Pages</b><br/>${p}`,
      msg_need:"Please upload a PDF first.",
      msg_bad:"Invalid page range. Example: 1-3,5,8-10",
      msg_ok:"âœ… Download ready",
      msg_fail:"Failed to process PDF.",
      err_zip_lib:"ZIP library is not ready.",
      progress:(pct)=>`Processingâ€¦ ${pct}%`,
      done:"Done."
    },
    ko:{
      page_title:"PDF ë¶„ë¦¬",
      page_sub:"ì—…ë¡œë“œ â†’ í˜ì´ì§€ ì„ íƒ â†’ ë‹¤ìš´ë¡œë“œ. 100% ë¡œì»¬ ì²˜ë¦¬.",
      home:"ğŸ  í™ˆìœ¼ë¡œ",
      local:"ë¡œì»¬ ì²˜ë¦¬ â€” ì„œë²„ ì—…ë¡œë“œ ì—†ìŒ",
      lang_label:"ì–¸ì–´",
      h1:"PDF ì—…ë¡œë“œ",
      pick:"ğŸ“„ PDF ì„ íƒ",
      clear:"ğŸ§¹ ë¹„ìš°ê¸°",
      drop_title:"ì—¬ê¸°ì— PDFë¥¼ ëŒì–´ë‹¤ ë†“ê±°ë‚˜<br/>íƒ­í•´ì„œ ì—…ë¡œë“œ",
      drop_hint:"íŒ: í° PDFëŠ” ëª¨ë°”ì¼ì—ì„œ ì¡°ê¸ˆ ê±¸ë¦´ ìˆ˜ ìˆì–´ìš”.",
      h2:"í˜ì´ì§€",
      lbl_range:"ì¶”ì¶œí•  í˜ì´ì§€",
      range_ph:"ì˜ˆ: 1-3, 5, 8-10",
      range_hint:"í˜ì´ì§€ëŠ” 1ë¶€í„° ì‹œì‘. ì½¤ë§ˆ/êµ¬ê°„ ì§€ì›.",
      zip:"ì „ì²´ ë¶„ë¦¬ â†’ ZIP(í˜ì´ì§€ë³„ PDF)",
      zip_hint_on:"ZIP ëª¨ë“œ ON: ì „ì²´ í˜ì´ì§€ë¥¼ 1í˜ì´ì§€ì”© ë‚˜ëˆ  ZIPìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.",
      dl:"â¬‡ï¸ ì„ íƒ í˜ì´ì§€ PDF ë‹¤ìš´ë¡œë“œ",
      dl_zip:"â¬‡ï¸ ì „ì²´ ë¶„ë¦¬ ZIP ë‹¤ìš´ë¡œë“œ",
      meta_idle:"<b>ìƒíƒœ</b><br/>PDFë¥¼ ì—…ë¡œë“œí•˜ë©´ í˜ì´ì§€ ìˆ˜ê°€ í‘œì‹œë¼ìš”.",
      meta_loaded:(name,p)=>`<b>PDF</b><br/>${escapeHtml(name)}<br/><b>í˜ì´ì§€</b><br/>${p}`,
      msg_need:"ë¨¼ì € PDFë¥¼ ì—…ë¡œë“œí•´ ì£¼ì„¸ìš”.",
      msg_bad:"í˜ì´ì§€ ë²”ìœ„ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ìš”. ì˜ˆ: 1-3,5,8-10",
      msg_ok:"âœ… ë‹¤ìš´ë¡œë“œ ì¤€ë¹„ ì™„ë£Œ",
      msg_fail:"PDF ì²˜ë¦¬ ì‹¤íŒ¨",
      err_zip_lib:"ZIP ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ì–´ìš”.",
      progress:(pct)=>`ì²˜ë¦¬ ì¤‘â€¦ ${pct}%`,
      done:"ì™„ë£Œ"
    },
    es:{
      page_title:"Dividir PDF",
      page_sub:"Sube â†’ elige pÃ¡ginas â†’ descarga. 100% local.",
      home:"ğŸ  Inicio",
      local:"Procesado local â€” sin servidor",
      lang_label:"Idioma",
      h1:"Subir PDF",
      pick:"ğŸ“„ Elegir PDF",
      clear:"ğŸ§¹ Limpiar",
      drop_title:"Suelta el PDF aquÃ­<br/>o toca para subir",
      drop_hint:"Consejo: PDFs grandes pueden tardar en mÃ³vil.",
      h2:"PÃ¡ginas",
      lbl_range:"PÃ¡ginas a extraer",
      range_ph:"ej. 1-3, 5, 8-10",
      range_hint:"PÃ¡ginas desde 1. Comas y rangos.",
      zip:"Dividir TODO â†’ ZIP",
      zip_hint_on:"ZIP activado. Se crearÃ¡ 1 PDF por pÃ¡gina.",
      dl:"â¬‡ï¸ Descargar PDF extraÃ­do",
      dl_zip:"â¬‡ï¸ Descargar ZIP (todas)",
      meta_idle:"<b>Estado</b><br/>Sube un PDF para ver pÃ¡ginas.",
      meta_loaded:(name,p)=>`<b>PDF</b><br/>${escapeHtml(name)}<br/><b>PÃ¡ginas</b><br/>${p}`,
      msg_need:"Primero sube un PDF.",
      msg_bad:"Rango invÃ¡lido. Ej: 1-3,5,8-10",
      msg_ok:"âœ… Listo",
      msg_fail:"Error al procesar PDF.",
      err_zip_lib:"La librerÃ­a ZIP no estÃ¡ lista.",
      progress:(pct)=>`Procesandoâ€¦ ${pct}%`,
      done:"Hecho."
    },
    ja:{
      page_title:"PDF åˆ†å‰²",
      page_sub:"ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ ãƒšãƒ¼ã‚¸é¸æŠ â†’ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€‚100% ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã€‚",
      home:"ğŸ  ãƒ›ãƒ¼ãƒ ",
      local:"ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç† â€” ã‚µãƒ¼ãƒãƒ¼ãªã—",
      lang_label:"è¨€èª",
      h1:"PDF ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
      pick:"ğŸ“„ PDF ã‚’é¸æŠ",
      clear:"ğŸ§¹ ã‚¯ãƒªã‚¢",
      drop_title:"ã“ã“ã«PDFã‚’ãƒ‰ãƒ­ãƒƒãƒ—<br/>ã¾ãŸã¯ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠ",
      drop_hint:"ãƒ’ãƒ³ãƒˆ: å¤§ãã„PDFã¯å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚",
      h2:"ãƒšãƒ¼ã‚¸",
      lbl_range:"æŠ½å‡ºã™ã‚‹ãƒšãƒ¼ã‚¸",
      range_ph:"ä¾‹: 1-3, 5, 8-10",
      range_hint:"ãƒšãƒ¼ã‚¸ã¯1ã‹ã‚‰ã€‚ã‚«ãƒ³ãƒ/ç¯„å›²å¯¾å¿œã€‚",
      zip:"å…¨ãƒšãƒ¼ã‚¸ â†’ ZIP",
      zip_hint_on:"ZIP ON: 1ãƒšãƒ¼ã‚¸ãšã¤PDFã«åˆ†å‰²ã—ã¾ã™ã€‚",
      dl:"â¬‡ï¸ æŠ½å‡ºPDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
      dl_zip:"â¬‡ï¸ ZIPã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰(å…¨ãƒšãƒ¼ã‚¸)",
      meta_idle:"<b>çŠ¶æ…‹</b><br/>PDFã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚",
      meta_loaded:(name,p)=>`<b>PDF</b><br/>${escapeHtml(name)}<br/><b>ãƒšãƒ¼ã‚¸</b><br/>${p}`,
      msg_need:"å…ˆã«PDFã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚",
      msg_bad:"ç¯„å›²ãŒç„¡åŠ¹ã§ã™ã€‚ä¾‹: 1-3,5,8-10",
      msg_ok:"âœ… æº–å‚™OK",
      msg_fail:"PDFã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
      err_zip_lib:"ZIPãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æº–å‚™ãŒã§ãã¦ã„ã¾ã›ã‚“ã€‚",
      progress:(pct)=>`å‡¦ç†ä¸­â€¦ ${pct}%`,
      done:"å®Œäº†"
    }
  };

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, (m)=>({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
    }[m]));
  }

  function getQueryLang(){
    try{
      const u = new URL(location.href);
      const q = (u.searchParams.get("lang")||"").toLowerCase();
      if(q && STR[q]) return q;
    }catch(e){}
    return null;
  }
  function detectLang(){
    const q = getQueryLang();
    if(q) return q;
    const saved = localStorage.getItem("cf24_lang");
    if(saved && STR[saved]) return saved;
    const nav = (navigator.language || "").toLowerCase();
    if(nav.startsWith("ko")) return "ko";
    if(nav.startsWith("ja")) return "ja";
    if(nav.startsWith("es")) return "es";
    return "en";
  }
  let LANG = detectLang();
  function t(){ return STR[LANG] || STR.en; }

  const pickInput = $("pickInput");
  const pickBtn = $("pickBtn");
  const clearBtn = $("clearBtn");
  const drop = $("drop");
  const rangeEl = $("range");
  const downloadBtn = $("downloadBtn");
  const msgEl = $("msg");
  const metaEl = $("meta");
  const zipModeEl = $("zipMode");
  const zipTextEl = $("zip_text");
  const dropBadge = $("dropBadge");
  const dropBadgeText = $("dropBadgeText");

  const progressWrap = $("progressWrap");
  const progressBar = $("progressBar");
  const progressText = $("progressText");

  function setMsg(text, cls){
    msgEl.textContent = text || "";
    msgEl.className = "msg " + (cls || "");
  }

  function showProgress(){
    progressWrap.style.display = "block";
    progressText.style.display = "block";
    setProgress(0);
  }
  function hideProgress(){
    progressWrap.style.display = "none";
    progressText.style.display = "none";
    progressBar.style.width = "0%";
    progressText.textContent = "";
  }
  function setProgress(pct){
    const p = Math.max(0, Math.min(100, Math.round(pct)));
    progressBar.style.width = p + "%";
    progressText.textContent = (p >= 100) ? t().done : t().progress(p);
  }

  let pdfBytes = null;
  let pdfName = "document.pdf";
  let pageCount = 0;
  let busy = false;

  function setLang(lang){
    if(!STR[lang]) lang = "en";
    LANG = lang;
    localStorage.setItem("cf24_lang", lang);
    $("langSelect").value = lang;
    document.documentElement.lang = lang;

    $("page_title").textContent = t().page_title;
    $("page_sub").textContent = t().page_sub;
    $("home_btn").textContent = t().home;
    $("local_processing").textContent = t().local;
    $("lang_label").textContent = t().lang_label;

    $("h_step1").textContent = t().h1;
    pickBtn.textContent = t().pick;
    clearBtn.textContent = t().clear;
    $("drop_title").innerHTML = t().drop_title;
    $("drop_hint").textContent = t().drop_hint;

    $("h_step2").textContent = t().h2;
    $("lbl_range").textContent = t().lbl_range;
    rangeEl.placeholder = t().range_ph;

    zipTextEl.textContent = t().zip;
    downloadBtn.textContent = zipModeEl.checked ? t().dl_zip : t().dl;

    if(!pdfBytes) metaEl.innerHTML = t().meta_idle;
    refreshZipHint();
    refreshBadge();
  }
  $("langSelect").addEventListener("change", (e)=> setLang(e.target.value));

  function refreshBadge(){
    if(!dropBadge || !dropBadgeText) return;
    if(pdfBytes && pageCount > 0){
      dropBadge.style.display = "inline-flex";
      dropBadgeText.textContent = `${pageCount}p`;
      drop.classList.add("hasBadge");
    }else{
      dropBadge.style.display = "none";
      dropBadgeText.textContent = "0";
      drop.classList.remove("hasBadge");
    }
  }

  function refreshZipHint(){
    const hintEl = $("range_hint");
    if(!hintEl) return;
    hintEl.textContent = zipModeEl.checked ? t().zip_hint_on : t().range_hint;
  }

  function setBusy(on){
    busy = !!on;
    pickBtn.disabled = busy;
    clearBtn.disabled = busy || !pdfBytes;
    drop.style.pointerEvents = busy ? "none" : "auto";
    rangeEl.disabled = busy || !pdfBytes || zipModeEl.checked;
    zipModeEl.disabled = busy || !pdfBytes;
    downloadBtn.disabled = busy || !pdfBytes; // âœ… pdfë§Œ ìˆìœ¼ë©´ ë²„íŠ¼ì€ ì¼œë‘ê³ , ì…ë ¥ê²€ì¦ì€ í´ë¦­ ì‹œ ì²˜ë¦¬
  }

  pickBtn.addEventListener("click", ()=>{ pickInput.value=""; pickInput.click(); });
  pickInput.addEventListener("change", (e)=>{
    const f = e.target.files && e.target.files[0];
    if(f) loadFile(f);
  });

  function openDropPicker(){ pickInput.value=""; pickInput.click(); }
  drop.addEventListener("click", openDropPicker);
  drop.addEventListener("keydown", (e)=>{
    if(e.key === "Enter" || e.key === " "){ e.preventDefault(); openDropPicker(); }
  });

  ["dragenter","dragover"].forEach(evt=>{
    drop.addEventListener(evt, (e)=>{ e.preventDefault(); e.stopPropagation(); drop.classList.add("drag"); });
  });
  ["dragleave","drop"].forEach(evt=>{
    drop.addEventListener(evt, (e)=>{ e.preventDefault(); e.stopPropagation(); drop.classList.remove("drag"); });
  });
  drop.addEventListener("drop", (e)=>{
    const f = e.dataTransfer.files && e.dataTransfer.files[0];
    if(f) loadFile(f);
  });

  clearBtn.addEventListener("click", ()=>{
    if(busy) return;
    pdfBytes = null; pdfName="document.pdf"; pageCount=0;
    rangeEl.value = "";
    rangeEl.disabled = true;
    zipModeEl.checked = false;
    zipModeEl.disabled = true;
    downloadBtn.disabled = true;
    clearBtn.disabled = true;
    drop.classList.remove("active","hasBadge");
    metaEl.innerHTML = t().meta_idle;
    setMsg("", "");
    hideProgress();
    refreshZipHint();
    refreshBadge();
    downloadBtn.textContent = t().dl;
  });

  zipModeEl.addEventListener("change", ()=>{
    if(!pdfBytes || busy) return;
    rangeEl.disabled = zipModeEl.checked;
    downloadBtn.textContent = zipModeEl.checked ? t().dl_zip : t().dl;
    refreshZipHint();
  });

  async function loadFile(file){
    try{
      setMsg("", "");
      hideProgress();
      setBusy(true);

      const buf = await file.arrayBuffer();
      const { PDFDocument } = window.PDFLib;
      const doc = await PDFDocument.load(buf, { ignoreEncryption:false });

      pdfBytes = buf;
      pdfName = file.name || "document.pdf";
      pageCount = doc.getPageCount();

      drop.classList.add("active");
      rangeEl.disabled = false;
      zipModeEl.disabled = false;
      clearBtn.disabled = false;
      downloadBtn.disabled = false;

      metaEl.innerHTML = t().meta_loaded(pdfName, pageCount);
      refreshZipHint();
      refreshBadge();
      setBusy(false);
    }catch(err){
      pdfBytes = null; pageCount=0;
      drop.classList.remove("active","hasBadge");
      rangeEl.disabled = true;
      zipModeEl.disabled = true;
      downloadBtn.disabled = true;
      clearBtn.disabled = true;
      metaEl.innerHTML = t().meta_idle;
      setMsg(t().msg_fail, "err");
      refreshBadge();
      setBusy(false);
    }
  }

  function parseRanges(input, maxPage){
    const s = String(input || "").replace(/\s+/g,"");
    if(!s) return null;
    const parts = s.split(",").filter(Boolean);
    const out = new Set();

    for(const p of parts){
      if(/^\d+$/.test(p)){
        const n = parseInt(p,10);
        if(n < 1 || n > maxPage) return null;
        out.add(n-1);
        continue;
      }
      if(/^\d+\-\d+$/.test(p)){
        const [a,b] = p.split("-").map(x=>parseInt(x,10));
        if(a < 1 || b < 1 || a > maxPage || b > maxPage) return null;
        const start = Math.min(a,b);
        const end = Math.max(a,b);
        for(let i=start;i<=end;i++) out.add(i-1);
        continue;
      }
      return null;
    }
    return Array.from(out).sort((x,y)=>x-y);
  }

  function downloadBlob(blob, filename){
    const a = document.createElement("a");
    const url = URL.createObjectURL(blob);
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 1500);
  }

  function buildName(ext){
    const stamp = new Date().toISOString().replace(/[:.]/g,"-");
    const base = (pdfName || "document.pdf").replace(/\.[^.]+$/, "");
    return `${base}_split_${stamp}.${ext}`;
  }

  function buildZipName(){
    const stamp = new Date().toISOString().replace(/[:.]/g,"-");
    const base = (pdfName || "document.pdf").replace(/\.[^.]+$/, "");
    return `${base}_pages_${stamp}.zip`;
  }

  async function splitAllToZip(){
    if(!window.JSZip) throw new Error(t().err_zip_lib);

    const { PDFDocument } = window.PDFLib;
    const src = await PDFDocument.load(pdfBytes);
    const zip = new window.JSZip();

    const total = pageCount;
    for(let i=0;i<total;i++){
      setProgress((i / Math.max(1,total)) * 100);

      const out = await PDFDocument.create();
      const [p] = await out.copyPages(src, [i]);
      out.addPage(p);
      const bytes = await out.save({ useObjectStreams:true });

      const num = String(i+1).padStart(3,"0");
      zip.file(`page_${num}.pdf`, bytes);
    }
    setProgress(100);

    const blob = await zip.generateAsync({ type:"blob" }, (meta)=>{
      setProgress(meta.percent);
    });
    setProgress(100);
    return blob;
  }

  downloadBtn.addEventListener("click", async ()=>{
    try{
      if(busy) return;
      if(!pdfBytes) return setMsg(t().msg_need, "err");

      setMsg("", "");
      showProgress();
      setBusy(true);

      if(zipModeEl.checked){
        const zipBlob = await splitAllToZip();
        downloadBlob(zipBlob, buildZipName());
        setMsg(t().msg_ok, "ok");
        setTimeout(hideProgress, 500);
        setBusy(false);
        return;
      }

      const idx = parseRanges(rangeEl.value, pageCount);
      if(!idx || idx.length === 0){
        setBusy(false);
        hideProgress();
        return setMsg(t().msg_bad, "err");
      }

      const { PDFDocument } = window.PDFLib;
      const src = await PDFDocument.load(pdfBytes);
      const out = await PDFDocument.create();

      const total = idx.length;
      for(let i=0;i<total;i++){
        const copied = await out.copyPages(src, [idx[i]]);
        copied.forEach(p=>out.addPage(p));
        setProgress(((i+1) / Math.max(1,total)) * 100);
      }

      const bytes = await out.save({ useObjectStreams:true });
      const blob = new Blob([bytes], { type:"application/pdf" });
      downloadBlob(blob, buildName("pdf"));

      setMsg(t().msg_ok, "ok");
      setTimeout(hideProgress, 500);
      setBusy(false);
    }catch(e){
      setBusy(false);
      hideProgress();
      setMsg(t().msg_fail, "err");
    }
  });

  setLang(LANG);
  zipModeEl.disabled = true;
  refreshBadge();
})();
</script>
</body>
</html>