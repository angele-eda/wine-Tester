<!doctype html>
<html lang="en" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- âœ… SEO ê¸°ë³¸ -->
  <title>ConvertFiles24 â€“ Free Image Converter (JPG, PNG, WebP, PDF)</title>
  <meta name="description" content="Upload images, convert to JPG/PNG/WebP/PDF, and download instantly â€” processed locally in your browser. Multiple images can download as a ZIP or individually. PDFs can be merged." />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#0b0f17" />
  <link rel="canonical" href="https://convertfiles24.com/" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ConvertFiles24 - Image Converter" />
  <meta property="og:description" content="Convert JPG/PNG/WebP/PDF instantly â€” local in-browser processing. Multi-images: ZIP or individual. PDFs can be merged." />
  <meta property="og:url" content="https://convertfiles24.com/" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ConvertFiles24 - Image Converter" />
  <meta name="twitter:description" content="Convert JPG/PNG/WebP/PDF instantly â€” local in-browser processing. Multi-images: ZIP or individual. PDFs can be merged." />

  <!-- êµ¬ì¡°í™” ë°ì´í„° -->
  <script type="application/ld+json" id="jsonld">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"ConvertFiles24",
    "applicationCategory":"MultimediaApplication",
    "operatingSystem":"Web",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "url":"https://convertfiles24.com/"
  }
  </script>

  <!-- âœ… PDF ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë¸Œë¼ìš°ì € ë¡œì»¬ ì²˜ë¦¬) -->
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <!-- âœ… ZIP ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë¸Œë¼ìš°ì € ë¡œì»¬ ì²˜ë¦¬) -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <style>
    :root { --radius:16px; --pad:16px; --border:1px solid rgba(255,255,255,.12); }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, Noto Sans KR, sans-serif;
      background:#0b0f17; color:#e9eef7;
    }
    .wrap{ max-width:980px; margin:0 auto; padding:22px 14px 44px; }
    .top{
      display:flex; align-items:flex-start; justify-content:space-between;
      gap:12px; flex-wrap:wrap; margin-bottom:14px;
    }
    h1{ margin:0; font-size:20px; letter-spacing:-.2px; }
    .sub{ margin:6px 0 0; color:#a7b3c7; font-size:13px; line-height:1.45; }

    /* âœ… language bar fixed (PCì—ì„œë„ ì•ˆ ë°€ë¦¼) */
    .langbar{
      display:flex; gap:8px; align-items:center; justify-content:flex-end;
      flex-wrap:nowrap;
    }
    .langbtn{
      font-size:12px; font-weight:700;
      color:#b8c6dc; border:var(--border);
      padding:9px 12px; border-radius:999px;
      background:rgba(255,255,255,.04);
      cursor:pointer; user-select:none;
      white-space:nowrap;
    }
    .langbtn.active{
      color:#e9eef7;
      background:rgba(47,109,246,.22);
      border-color:rgba(47,109,246,.55);
    }

    .grid{ display:grid; grid-template-columns: 1.2fr .8fr; gap:12px; }
    @media (max-width: 860px){ .grid{ grid-template-columns:1fr; } }
    .card{
      border:var(--border); background:rgba(255,255,255,.03); border-radius:var(--radius);
      padding:var(--pad);
    }
    .card h2{ margin:0 0 10px; font-size:15px; color:#dbe7ff; }
    .drop{
      border:1px dashed rgba(255,255,255,.18); border-radius:14px; padding:18px;
      display:flex; align-items:center; justify-content:center; text-align:center;
      background:rgba(255,255,255,.02);
    }
    .drop.drag{ background:rgba(106,169,255,.12); border-color:rgba(106,169,255,.45); }
    .btn{
      appearance:none; border:none; cursor:pointer;
      background:#2f6df6; color:white; font-weight:800;
      padding:12px 14px; border-radius:14px; width:100%;
      font-size:15px;
    }
    .btn:disabled{ opacity:.45; cursor:not-allowed; }
    .btn.secondary{ background:rgba(255,255,255,.10); color:#e9eef7; border:var(--border); }
    .row{ display:flex; gap:10px; flex-wrap:wrap; }
    .row > * { flex:1; min-width:160px; }
    label{ display:block; font-size:12px; color:#a7b3c7; margin-bottom:6px; }
    input[type="file"]{ display:none; }
    select, input[type="number"]{
      width:100%; box-sizing:border-box; padding:12px 12px; border-radius:14px;
      background:rgba(255,255,255,.06); color:#e9eef7; border:var(--border);
      outline:none;
    }
    /* select/option ê°€ë…ì„± */
    select { background-color: #0b0f17; color: #e9eef7; border: 1px solid rgba(255,255,255,.2); }
    option { background-color: #0b0f17; color: #e9eef7; }

    .preview{
      display:grid; grid-template-columns: 140px 1fr; gap:12px; align-items:center;
    }
    .thumb{
      width:140px; height:140px; border-radius:14px; border:var(--border);
      background:rgba(255,255,255,.03); display:flex; align-items:center; justify-content:center;
      overflow:hidden;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; }
    .meta{ color:#b7c3d9; font-size:13px; line-height:1.5; }
    .meta b{ color:#e9eef7; }
    .hint{ margin-top:10px; color:#9fb0ca; font-size:12px; line-height:1.5; }
    .msg{ margin-top:10px; font-size:13px; color:#cfe0ff; }
    .err{ color:#ffb4b4; }
    .ok{ color:#b8ffcc; }
    .footer{ margin-top:14px; color:#94a6c2; font-size:12px; text-align:center; }

    /* âœ… pages list */
    .pagesWrap{ margin-top:12px; display:none; }
    .pagesHead{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      margin:10px 0 8px;
    }
    .pagesTitle{ font-size:13px; color:#dbe7ff; font-weight:800; }
    .pagesSmall{ font-size:12px; color:#9fb0ca; }
    .pageList{ display:flex; flex-direction:column; gap:8px; }
    .pageItem{
      border:var(--border); border-radius:14px; background:rgba(255,255,255,.03);
      padding:10px; display:flex; gap:10px; align-items:center;
    }
    .pageThumb{
      width:52px; height:52px; border-radius:12px; border:var(--border);
      background:rgba(255,255,255,.02); overflow:hidden; flex:0 0 auto;
      display:flex; align-items:center; justify-content:center;
    }
    .pageThumb img{ width:100%; height:100%; object-fit:cover; }
    .pageInfo{ flex:1; min-width:0; }
    .pageName{ font-size:12px; color:#e9eef7; font-weight:700; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .pageMeta{ font-size:11px; color:#9fb0ca; margin-top:4px; }
    .pageBtns{ display:flex; gap:6px; flex:0 0 auto; }
    .iconBtn{
      border:var(--border); background:rgba(255,255,255,.04);
      color:#e9eef7; border-radius:12px; padding:8px 9px;
      cursor:pointer; font-weight:900; font-size:12px;
      line-height:1; user-select:none;
    }
    .iconBtn:disabled{ opacity:.35; cursor:not-allowed; }

    /* âœ… mode box (PDF/ZIP ì„¤ëª… + ë¼ë””ì˜¤) */
    .modeBox{
      border:var(--border); background:rgba(255,255,255,.02);
      border-radius:14px; padding:12px; margin-top:12px; display:none;
    }
    .modeTitle{ font-size:13px; color:#dbe7ff; font-weight:800; margin-bottom:8px; }
    .modeDesc{ font-size:12px; color:#a7b3c7; line-height:1.5; }
    .modeRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .radio{
      border:var(--border); border-radius:14px; padding:10px 12px;
      background:rgba(255,255,255,.03); cursor:pointer; user-select:none;
      display:flex; gap:8px; align-items:flex-start; flex:1; min-width:220px;
    }
    .radio input{ margin-top:2px; }
    .radio strong{ display:block; color:#e9eef7; font-size:12px; }
    .radio span{ display:block; color:#a7b3c7; font-size:12px; line-height:1.45; margin-top:2px; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>ConvertFiles24</h1>
        <p class="sub" id="subtitle"></p>
      </div>

      <div class="langbar" aria-label="Language selector">
        <div class="langbtn" data-lang="en">EN</div>
        <div class="langbtn" data-lang="es">ES</div>
        <div class="langbtn" data-lang="ja">æ—¥æœ¬èª</div>
        <div class="langbtn" data-lang="ko">KO</div>
      </div>
    </div>

    <div class="grid">
      <!-- Left -->
      <div class="card">
        <h2 id="h_upload"></h2>

        <div class="drop" id="drop">
          <div>
            <div style="font-weight:800; margin-bottom:8px;" id="drop_title"></div>
            <label for="file" style="display:inline-block; cursor:pointer;">
              <span class="btn secondary" style="display:inline-block; width:auto; padding:10px 14px;" id="pick_btn"></span>
            </label>

            <!-- âœ… multiple ì„ íƒ -->
            <input id="file" type="file" accept="image/*" multiple />

            <div class="hint" id="drop_hint"></div>
          </div>
        </div>

        <!-- Pages list (order/delete) -->
        <div class="pagesWrap" id="pagesWrap">
          <div class="pagesHead">
            <div class="pagesTitle" id="pagesTitle"></div>
            <div class="pagesSmall" id="pagesSmall"></div>
          </div>
          <div class="pageList" id="pageList"></div>
          <div class="hint" id="pagesHint"></div>
        </div>

        <div style="height:12px;"></div>

        <h2 id="h_preview"></h2>
        <div class="preview">
          <div class="thumb" id="thumb"></div>
          <div class="meta" id="meta"></div>
        </div>

        <div class="msg" id="msg"></div>
      </div>

      <!-- Right -->
      <div class="card">
        <h2 id="h_settings"></h2>

        <div class="row">
          <div>
            <label id="lbl_format"></label>
            <select id="format">
              <option value="image/jpeg">JPG</option>
              <option value="image/png">PNG</option>
              <option value="image/webp">WebP</option>
              <option value="application/pdf">PDF</option>
            </select>
          </div>

          <div>
            <label id="lbl_quality"></label>
            <select id="quality">
              <option value="0.95" id="q_095"></option>
              <option value="0.9" selected id="q_090"></option>
              <option value="0.8" id="q_080"></option>
              <option value="0.7" id="q_070"></option>
            </select>
          </div>
        </div>

        <div style="height:10px;"></div>

        <div class="row">
          <div>
            <label id="lbl_w"></label>
            <input id="w" type="number" min="1" />
          </div>
          <div>
            <label id="lbl_h"></label>
            <input id="h" type="number" min="1" />
          </div>
        </div>

        <div class="hint" id="size_hint"></div>

        <!-- âœ… PDF/ZIP ì°¨ì´ ì„¤ëª… + PDF/ì´ë¯¸ì§€ ëª¨ë“œ -->
        <div class="modeBox" id="modeBox">
          <div class="modeTitle" id="modeTitle"></div>
          <div class="modeDesc" id="modeDesc"></div>

          <!-- PDF mode -->
          <div class="modeRow" id="pdfModeRow">
            <label class="radio">
              <input type="radio" name="pdfmode" value="single" checked />
              <div>
                <strong id="pdf_one_title"></strong>
                <span id="pdf_one_desc"></span>
              </div>
            </label>

            <label class="radio">
              <input type="radio" name="pdfmode" value="merge" />
              <div>
                <strong id="pdf_merge_title"></strong>
                <span id="pdf_merge_desc"></span>
              </div>
            </label>
          </div>

          <!-- Image multi-download mode -->
          <div class="modeRow" id="imgModeRow" style="margin-top:10px;">
            <label class="radio">
              <input type="radio" name="imgmode" value="zip" checked />
              <div>
                <strong id="img_zip_title"></strong>
                <span id="img_zip_desc"></span>
              </div>
            </label>

            <label class="radio">
              <input type="radio" name="imgmode" value="single" />
              <div>
                <strong id="img_single_title"></strong>
                <span id="img_single_desc"></span>
              </div>
            </label>
          </div>
        </div>

        <div style="height:12px;"></div>

        <h2 id="h_download"></h2>
        <button class="btn" id="convert" disabled></button>
        <div style="height:10px;"></div>
        <button class="btn secondary" id="reset" disabled></button>

        <div class="hint" id="privacy_hint"></div>
      </div>
    </div>

    <div class="footer">
      Â© <span id="year"></span> ConvertFiles24 Â· Powered by GitHub Pages
    </div>
  </div>

<script>
(() => {
  const $ = (id) => document.getElementById(id);

  const fileInput = $("file");
  const drop = $("drop");
  const thumb = $("thumb");
  const meta = $("meta");
  const msg = $("msg");
  const btnConvert = $("convert");
  const btnReset = $("reset");
  const selFormat = $("format");
  const selQuality = $("quality");
  const inW = $("w");
  const inH = $("h");

  const pagesWrap = $("pagesWrap");
  const pageList = $("pageList");
  const pagesTitle = $("pagesTitle");
  const pagesSmall = $("pagesSmall");
  const pagesHint = $("pagesHint");

  const modeBox = $("modeBox");
  const modeTitle = $("modeTitle");
  const modeDesc  = $("modeDesc");
  const pdfModeRow = $("pdfModeRow");

  const pdfModeRadios = () => Array.from(document.querySelectorAll('input[name="pdfmode"]'));
  const imgModeRadios = () => Array.from(document.querySelectorAll('input[name="imgmode"]'));

  $("year").textContent = new Date().getFullYear();

  // =========================
  // i18n (KO/EN/JA/ES)
  // =========================
  const STR = {
    ko: {
      seoTitle: "ConvertFiles24 - ì´ë¯¸ì§€ ë³€í™˜",
      seoDesc: "ì´ë¯¸ì§€ ì—…ë¡œë“œ í›„ JPG/PNG/WebP/PDFë¡œ ë³€í™˜í•˜ê³  ë°”ë¡œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”. ì—¬ëŸ¬ ì¥ì€ ZIP ë˜ëŠ” ê°œë³„, PDFëŠ” í•©ì¹˜ê¸° ê°€ëŠ¥. ë¸Œë¼ìš°ì € ë¡œì»¬ ì²˜ë¦¬.",
      ogTitle: "ConvertFiles24 - ì´ë¯¸ì§€ ë³€í™˜",
      ogDesc: "JPG/PNG/WebP/PDF ë³€í™˜ â€” ì—¬ëŸ¬ ì¥ ZIP/ê°œë³„, PDF í•©ì¹˜ê¸°. ì„œë²„ ì—…ë¡œë“œ ì—†ì´ ë¸Œë¼ìš°ì € ì²˜ë¦¬.",
      subtitle: 'ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•œ ë’¤ <b>JPG / PNG / WebP / PDF</b>ë¡œ ë³€í™˜í•˜ê³  ë°”ë¡œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”. (ì„œë²„ ì—…ë¡œë“œ ì—†ì´ ë‚´ ë¸Œë¼ìš°ì €ì—ì„œ ì²˜ë¦¬)',
      h_upload: '1) ì—…ë¡œë“œ',
      drop_title: 'ì—¬ê¸°ì— íŒŒì¼ì„ ëŒì–´ë†“ê±°ë‚˜',
      pick_btn: 'íŒŒì¼ ì„ íƒ',
      drop_hint: 'ì§€ì›: JPG, PNG, WebP ë“± ì´ë¯¸ì§€ / ì—¬ëŸ¬ ì¥ ì„ íƒ ê°€ëŠ¥ / ëª¨ë°”ì¼ë„ OK',
      h_preview: '2) ë¯¸ë¦¬ë³´ê¸°',
      thumb_label: 'ë¯¸ë¦¬ë³´ê¸°',
      meta_idle: 'íŒŒì¼ì„ ì„ íƒí•˜ë©´ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.',
      h_settings: '3) ë³€í™˜ ì„¤ì •',
      lbl_format: 'ì¶œë ¥ í˜•ì‹',
      lbl_quality: 'í’ˆì§ˆ (JPG/WebPë§Œ)',
      q_095: 'ìµœê³ (0.95)',
      q_090: 'ë†’ìŒ(0.90)',
      q_080: 'ë³´í†µ(0.80)',
      q_070: 'ì••ì¶•(0.70)',
      lbl_w: 'ê°€ë¡œ(px) (ë¹„ìš°ë©´ ì›ë³¸)',
      lbl_h: 'ì„¸ë¡œ(px) (ë¹„ìš°ë©´ ì›ë³¸)',
      ph_w: 'ì˜ˆ: 1200',
      ph_h: 'ì˜ˆ: 800',
      size_hint: 'ê°€ë¡œ/ì„¸ë¡œë¥¼ í•˜ë‚˜ë§Œ ì…ë ¥í•˜ë©´ ë¹„ìœ¨ ìœ ì§€ë¡œ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.',
      h_download: '4) ë‹¤ìš´ë¡œë“œ',
      convert: 'ë³€í™˜ & ë‹¤ìš´ë¡œë“œ',
      reset: 'ì´ˆê¸°í™”',

      pagesTitle: 'Pages',
      pagesSmall: (n) => `ì„ íƒ: ${n}ì¥`,
      pagesHint: 'PDF í•©ì¹˜ê¸°ëŠ” ì´ ìˆœì„œë¥¼ ë”°ë¦…ë‹ˆë‹¤. (â¬†ï¸â¬‡ï¸ë¡œ ìˆœì„œ ë³€ê²½ / ğŸ—‘ï¸ë¡œ ì‚­ì œ)',

      modeTitle: 'PDF / ZIP ë™ì‘ ë°©ì‹',
      modeDesc:
        'â€¢ <b>JPG/PNG/WebP</b>: ì—¬ëŸ¬ ì¥ì€ <b>ZIP</b> ë˜ëŠ” <b>ê°œë³„ ë‹¤ìš´ë¡œë“œ</b>ë¥¼ ì„ íƒí•  ìˆ˜ ìˆì–´ìš”.<br/>' +
        'â€¢ <b>PDF</b>: ì—¬ëŸ¬ ì¥ì„ <b>í•œ PDFë¡œ í•©ì¹˜ê¸°</b>í•  ìˆ˜ ìˆì–´ìš”.',
      pdf_one_title: '1ì¥ PDF (ì²« ì´ë¯¸ì§€ 1ì¥)',
      pdf_one_desc: 'ì„ íƒí•œ ì´ë¯¸ì§€ ì¤‘ ì²« ë²ˆì§¸ë§Œ 1í˜ì´ì§€ PDFë¡œ ì €ì¥',
      pdf_merge_title: 'ì—¬ëŸ¬ ì´ë¯¸ì§€ â†’ í•œ PDFë¡œ í•©ì¹˜ê¸°',
      pdf_merge_desc: 'ì„ íƒ ìˆœì„œëŒ€ë¡œ PDF í˜ì´ì§€ë¡œ í•©ì³ 1ê°œ íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ',

      img_zip_title: 'ZIP (ì¶”ì²œ)',
      img_zip_desc: 'ì—¬ëŸ¬ ì¥ì„ ZIP 1ê°œë¡œ ë¬¶ì–´ í•œ ë²ˆì— ë‹¤ìš´ë¡œë“œ',
      img_single_title: 'ê°œë³„ ë‹¤ìš´ë¡œë“œ',
      img_single_desc: 'ë³€í™˜ëœ íŒŒì¼ì„ 1ì¥ì”© ë‹¤ìš´ë¡œë“œ (ë¸Œë¼ìš°ì €ê°€ ì—¬ëŸ¬ ë‹¤ìš´ë¡œë“œë¥¼ ë§‰ì„ ìˆ˜ ìˆìŒ)',

      privacy_hint:
        'ğŸ”’ ê°œì¸ì •ë³´: íŒŒì¼ì€ ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br/>' +
        'âœ… ëª¨ë“  ë³€í™˜ì€ ë¸Œë¼ìš°ì €ì—ì„œ ë¡œì»¬ ì²˜ë¦¬ë©ë‹ˆë‹¤.<br/>' +
        'ğŸ“¦ ì—¬ëŸ¬ ì¥: ZIP/ê°œë³„ ì„ íƒ Â· ğŸ“„ PDF: í•©ì¹˜ê¸° ê°€ëŠ¥',

      msg_loading: 'ì´ë¯¸ì§€ ë¡œë”© ì¤‘â€¦',
      msg_ready_1: 'ì¤€ë¹„ ì™„ë£Œ! ë³€í™˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.',
      msg_ready_multi: (n) => `ì¤€ë¹„ ì™„ë£Œ! ${n}ì¥ ì„ íƒë¨. ì˜¤ë¥¸ìª½ì—ì„œ ZIP/ê°œë³„ì„ ì„ íƒí•˜ì„¸ìš”.`,
      msg_png_q: 'PNGëŠ” ë¬´ì†ì‹¤ì´ë¼ í’ˆì§ˆ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì•„ìš”.',
      msg_pdf_note: 'PDFëŠ” í’ˆì§ˆ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì•„ìš”.',
      err_only_img: 'ì´ë¯¸ì§€ íŒŒì¼ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
      err_preview: 'ë¯¸ë¦¬ë³´ê¸°ì— ì‹¤íŒ¨í–ˆì–´ìš”.',
      err_upload_first: 'ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.',
      converting: 'ë³€í™˜ ì¤‘â€¦',
      zipping: (n) => `${n}ì¥ ë³€í™˜ ì¤‘â€¦ ZIP ìƒì„± ì¤‘â€¦`,
      downloading_multi: (n) => `${n}ì¥ ê°œë³„ ë‹¤ìš´ë¡œë“œ ì‹œì‘â€¦ (ë¸Œë¼ìš°ì €ê°€ ì°¨ë‹¨í•  ìˆ˜ ìˆì–´ìš”)`,
      err_convert: 'ë³€í™˜ ì‹¤íŒ¨. ë‹¤ë¥¸ ì˜µì…˜ìœ¼ë¡œ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.',
      err_zip: 'ZIP ìƒì„± ì‹¤íŒ¨. íŒŒì¼ ìˆ˜ë¥¼ ì¤„ì´ê±°ë‚˜ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.',
      err_multi_blocked: 'ë¸Œë¼ìš°ì €ê°€ ì—¬ëŸ¬ ë‹¤ìš´ë¡œë“œë¥¼ ì°¨ë‹¨í•  ìˆ˜ ìˆì–´ìš”. ZIP(ì¶”ì²œ)ìœ¼ë¡œ ì‹œë„í•´ ì£¼ì„¸ìš”.',
      dl_start: (name, size) => `ë‹¤ìš´ë¡œë“œ ì‹œì‘: ${name} (${size})`,
      meta_tpl_single: (name, type, size, w, h) =>
        `íŒŒì¼ëª…: <b>${name}</b><br/>í˜•ì‹: <b>${type}</b><br/>í¬ê¸°: <b>${size}</b><br/>í•´ìƒë„: <b>${w} Ã— ${h}</b>`,
      meta_tpl_multi: (count, totalSize) =>
        `ì„ íƒ íŒŒì¼: <b>${count}ê°œ</b><br/>ì´ ìš©ëŸ‰: <b>${totalSize}</b><br/>â€» ì´ë¯¸ì§€: ZIP/ê°œë³„ Â· PDF: í•©ì¹˜ê¸° ê°€ëŠ¥`,
      btn_up: 'ìœ„',
      btn_down: 'ì•„ë˜',
      btn_del: 'ì‚­ì œ'
    },

    en: {
      seoTitle: "ConvertFiles24 - Image Converter",
      seoDesc: "Upload images, convert to JPG/PNG/WebP/PDF, and download instantly â€” local in-browser processing. Multi-images: ZIP or individual. PDFs can be merged.",
      ogTitle: "ConvertFiles24 - Image Converter",
      ogDesc: "Convert JPG/PNG/WebP/PDF â€” Multi-images: ZIP or individual. PDFs can be merged. Local in-browser processing.",
      subtitle: 'Upload images and instantly convert to <b>JPG / PNG / WebP / PDF</b>. (Processed locally in your browser)',
      h_upload: '1) Upload',
      drop_title: 'Drag & drop files here, or',
      pick_btn: 'Choose files',
      drop_hint: 'Supports JPG, PNG, WebP / Multi-select supported / Mobile OK',
      h_preview: '2) Preview',
      thumb_label: 'Preview',
      meta_idle: 'Select files to see details.',
      h_settings: '3) Conversion settings',
      lbl_format: 'Output format',
      lbl_quality: 'Quality (JPG/WebP only)',
      q_095: 'Max (0.95)',
      q_090: 'High (0.90)',
      q_080: 'Normal (0.80)',
      q_070: 'Small (0.70)',
      lbl_w: 'Width (px) (blank = original)',
      lbl_h: 'Height (px) (blank = original)',
      ph_w: 'e.g., 1200',
      ph_h: 'e.g., 800',
      size_hint: 'If you enter only one side, the aspect ratio is preserved automatically.',
      h_download: '4) Download',
      convert: 'Convert & Download',
      reset: 'Reset',

      pagesTitle: 'Pages',
      pagesSmall: (n) => `Selected: ${n}`,
      pagesHint: 'PDF merge follows this order. (â¬†ï¸â¬‡ï¸ reorder / ğŸ—‘ï¸ delete)',

      modeTitle: 'PDF / ZIP behavior',
      modeDesc:
        'â€¢ <b>JPG/PNG/WebP</b>: choose <b>ZIP</b> or <b>individual downloads</b> for multiple images.<br/>' +
        'â€¢ <b>PDF</b>: you can <b>merge</b> multiple images into one PDF.',
      pdf_one_title: 'Single-page PDF (first image only)',
      pdf_one_desc: 'Saves only the first selected image as a 1-page PDF',
      pdf_merge_title: 'Merge images into one PDF',
      pdf_merge_desc: 'Merges selected images as PDF pages in order',

      img_zip_title: 'ZIP (Recommended)',
      img_zip_desc: 'Download all converted images in one ZIP file',
      img_single_title: 'Individual',
      img_single_desc: 'Downloads files one by one (your browser may block multiple downloads)',

      privacy_hint:
        'ğŸ”’ Privacy: files are never uploaded to a server.<br/>' +
        'âœ… All conversions run locally in your browser.<br/>' +
        'ğŸ“¦ Multi-images: ZIP/Individual Â· ğŸ“„ PDF: merge available',

      msg_loading: 'Loading imagesâ€¦',
      msg_ready_1: 'Ready! Click convert to download.',
      msg_ready_multi: (n) => `Ready! ${n} images selected. Choose ZIP or Individual on the right.`,
      msg_png_q: "PNG is lossless, so the quality setting doesn't apply.",
      msg_pdf_note: "Quality doesn't apply to PDF.",
      err_only_img: 'Images only.',
      err_preview: 'Failed to preview the image.',
      err_upload_first: 'Please upload images first.',
      converting: 'Convertingâ€¦',
      zipping: (n) => `Converting ${n} imagesâ€¦ creating ZIPâ€¦`,
      downloading_multi: (n) => `Starting ${n} individual downloadsâ€¦ (browser may block)`,
      err_convert: 'Conversion failed. Try different options.',
      err_zip: 'Failed to create ZIP. Try fewer files or retry.',
      err_multi_blocked: 'Your browser may block multiple downloads. Please try ZIP (recommended).',
      dl_start: (name, size) => `Download started: ${name} (${size})`,
      meta_tpl_single: (name, type, size, w, h) =>
        `Name: <b>${name}</b><br/>Type: <b>${type}</b><br/>Size: <b>${size}</b><br/>Resolution: <b>${w} Ã— ${h}</b>`,
      meta_tpl_multi: (count, totalSize) =>
        `Selected files: <b>${count}</b><br/>Total size: <b>${totalSize}</b><br/>Note: Images â†’ ZIP/Individual, PDF can merge`,
      btn_up: 'Up',
      btn_down: 'Down',
      btn_del: 'Del'
    },

    es: {
      seoTitle: "ConvertFiles24 - Convertidor de imÃ¡genes",
      seoDesc: "Sube imÃ¡genes, convierte a JPG/PNG/WebP/PDF y descarga al instante â€” procesamiento local en tu navegador. MÃºltiples imÃ¡genes: ZIP o individual. PDF se puede unir.",
      ogTitle: "ConvertFiles24 - Convertidor de imÃ¡genes",
      ogDesc: "Convierte JPG/PNG/WebP/PDF â€” mÃºltiples imÃ¡genes: ZIP o individual. PDF se puede unir. Procesamiento local.",
      subtitle: 'Sube imÃ¡genes y conviÃ©rtelas al instante a <b>JPG / PNG / WebP / PDF</b>. (Procesado localmente en tu navegador)',
      h_upload: '1) Subir',
      drop_title: 'Arrastra y suelta archivos aquÃ­, o',
      pick_btn: 'Elegir archivos',
      drop_hint: 'Soporta JPG, PNG, WebP / SelecciÃ³n mÃºltiple / Funciona en mÃ³vil',
      h_preview: '2) Vista previa',
      thumb_label: 'Vista previa',
      meta_idle: 'Selecciona archivos para ver detalles.',
      h_settings: '3) Ajustes de conversiÃ³n',
      lbl_format: 'Formato de salida',
      lbl_quality: 'Calidad (solo JPG/WebP)',
      q_095: 'MÃ¡x (0.95)',
      q_090: 'Alta (0.90)',
      q_080: 'Normal (0.80)',
      q_070: 'PequeÃ±o (0.70)',
      lbl_w: 'Ancho (px) (vacÃ­o = original)',
      lbl_h: 'Alto (px) (vacÃ­o = original)',
      ph_w: 'p.ej., 1200',
      ph_h: 'p.ej., 800',
      size_hint: 'Si introduces solo un lado, se mantiene la proporciÃ³n automÃ¡ticamente.',
      h_download: '4) Descargar',
      convert: 'Convertir y descargar',
      reset: 'Reiniciar',

      pagesTitle: 'PÃ¡ginas',
      pagesSmall: (n) => `Seleccionadas: ${n}`,
      pagesHint: 'La uniÃ³n de PDF sigue este orden. (â¬†ï¸â¬‡ï¸ reordenar / ğŸ—‘ï¸ eliminar)',

      modeTitle: 'Comportamiento PDF / ZIP',
      modeDesc:
        'â€¢ <b>JPG/PNG/WebP</b>: elige <b>ZIP</b> o <b>descargas individuales</b> para mÃºltiples imÃ¡genes.<br/>' +
        'â€¢ <b>PDF</b>: puedes <b>unir</b> varias imÃ¡genes en un solo PDF.',
      pdf_one_title: 'PDF de 1 pÃ¡gina (solo la primera imagen)',
      pdf_one_desc: 'Guarda Ãºnicamente la primera imagen seleccionada como PDF de 1 pÃ¡gina',
      pdf_merge_title: 'Unir imÃ¡genes en un PDF',
      pdf_merge_desc: 'Une las imÃ¡genes seleccionadas como pÃ¡ginas PDF en orden',

      img_zip_title: 'ZIP (Recomendado)',
      img_zip_desc: 'Descarga todas las imÃ¡genes convertidas en un solo archivo ZIP',
      img_single_title: 'Individual',
      img_single_desc: 'Descarga una por una (el navegador puede bloquear mÃºltiples descargas)',

      privacy_hint:
        'ğŸ”’ Privacidad: los archivos nunca se suben a un servidor.<br/>' +
        'âœ… Toda la conversiÃ³n se realiza localmente en tu navegador.<br/>' +
        'ğŸ“¦ MÃºltiples imÃ¡genes: ZIP/Individual Â· ğŸ“„ PDF: se puede unir',

      msg_loading: 'Cargando imÃ¡genesâ€¦',
      msg_ready_1: 'Â¡Listo! Pulsa convertir para descargar.',
      msg_ready_multi: (n) => `Â¡Listo! ${n} imÃ¡genes seleccionadas. Elige ZIP o Individual a la derecha.`,
      msg_png_q: "PNG es sin pÃ©rdida, asÃ­ que la calidad no aplica.",
      msg_pdf_note: "La calidad no aplica a PDF.",
      err_only_img: 'Solo imÃ¡genes.',
      err_preview: 'Error al previsualizar la imagen.',
      err_upload_first: 'Primero sube imÃ¡genes.',
      converting: 'Convirtiendoâ€¦',
      zipping: (n) => `Convirtiendo ${n} imÃ¡genesâ€¦ creando ZIPâ€¦`,
      downloading_multi: (n) => `Iniciando ${n} descargas individualesâ€¦ (el navegador puede bloquear)`,
      err_convert: 'La conversiÃ³n fallÃ³. Prueba otras opciones.',
      err_zip: 'No se pudo crear el ZIP. Prueba con menos archivos o reintenta.',
      err_multi_blocked: 'El navegador puede bloquear mÃºltiples descargas. Prueba ZIP (recomendado).',
      dl_start: (name, size) => `Descarga iniciada: ${name} (${size})`,
      meta_tpl_single: (name, type, size, w, h) =>
        `Nombre: <b>${name}</b><br/>Tipo: <b>${type}</b><br/>TamaÃ±o: <b>${size}</b><br/>ResoluciÃ³n: <b>${w} Ã— ${h}</b>`,
      meta_tpl_multi: (count, totalSize) =>
        `Archivos seleccionados: <b>${count}</b><br/>TamaÃ±o total: <b>${totalSize}</b><br/>Nota: ImÃ¡genes â†’ ZIP/Individual, PDF se puede unir`,
      btn_up: 'Arriba',
      btn_down: 'Abajo',
      btn_del: 'Eliminar'
    },

    ja: {
      seoTitle: "ConvertFiles24 - ç”»åƒå¤‰æ›",
      seoDesc: "ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ JPG/PNG/WebP/PDF ã«å¤‰æ›ã—ã€ã™ãã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚è¤‡æ•°ç”»åƒã¯ZIP/å€‹åˆ¥é¸æŠã€PDFã¯çµåˆå¯èƒ½ã€‚ãƒ–ãƒ©ã‚¦ã‚¶å†…ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã€‚",
      ogTitle: "ConvertFiles24 - ç”»åƒå¤‰æ›",
      ogDesc: "JPG/PNG/WebP/PDF å¤‰æ› â€” è¤‡æ•°ç”»åƒã¯ZIP/å€‹åˆ¥ã€PDFã¯çµåˆå¯èƒ½ã€‚ãƒ–ãƒ©ã‚¦ã‚¶å†…ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã€‚",
      subtitle: 'ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ <b>JPG / PNG / WebP / PDF</b> ã«å¤‰æ›ã—ã€ã™ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å‡¦ç†ãƒ»ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—ï¼‰',
      h_upload: '1) ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',
      drop_title: 'ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯',
      pick_btn: 'ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ',
      drop_hint: 'å¯¾å¿œ: JPG, PNG, WebP / è¤‡æ•°é¸æŠOK / ã‚¹ãƒãƒ›ã§ã‚‚åˆ©ç”¨å¯èƒ½',
      h_preview: '2) ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼',
      thumb_label: 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼',
      meta_idle: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã™ã‚‹ã¨æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚',
      h_settings: '3) å¤‰æ›è¨­å®š',
      lbl_format: 'å‡ºåŠ›å½¢å¼',
      lbl_quality: 'å“è³ªï¼ˆJPG/WebPã®ã¿ï¼‰',
      q_095: 'æœ€é«˜(0.95)',
      q_090: 'é«˜(0.90)',
      q_080: 'æ¨™æº–(0.80)',
      q_070: 'åœ§ç¸®(0.70)',
      lbl_w: 'å¹…(px)ï¼ˆç©ºæ¬„=å…ƒã‚µã‚¤ã‚ºï¼‰',
      lbl_h: 'é«˜ã•(px)ï¼ˆç©ºæ¬„=å…ƒã‚µã‚¤ã‚ºï¼‰',
      ph_w: 'ä¾‹: 1200',
      ph_h: 'ä¾‹: 800',
      size_hint: 'ç‰‡æ–¹ã ã‘å…¥åŠ›ã™ã‚‹ã¨ã€æ¯”ç‡ã‚’ç¶­æŒã—ã¦è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚',
      h_download: '4) ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
      convert: 'å¤‰æ›ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
      reset: 'ãƒªã‚»ãƒƒãƒˆ',

      pagesTitle: 'Pages',
      pagesSmall: (n) => `é¸æŠ: ${n}æš`,
      pagesHint: 'PDFçµåˆã¯ã“ã®é †åºã«å¾“ã„ã¾ã™ã€‚ï¼ˆâ¬†ï¸â¬‡ï¸ã§é †ç•ªå¤‰æ›´ / ğŸ—‘ï¸ã§å‰Šé™¤ï¼‰',

      modeTitle: 'PDF / ZIP ã®å‹•ä½œ',
      modeDesc:
        'â€¢ <b>JPG/PNG/WebP</b>: è¤‡æ•°ç”»åƒã¯ <b>ZIP</b> ã¾ãŸã¯ <b>å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</b>ã‚’é¸ã¹ã¾ã™ã€‚<br/>' +
        'â€¢ <b>PDF</b>: è¤‡æ•°ç”»åƒã‚’ <b>1ã¤ã®PDFã«çµåˆ</b>ã§ãã¾ã™ã€‚',
      pdf_one_title: '1ãƒšãƒ¼ã‚¸PDFï¼ˆå…ˆé ­ã®ç”»åƒã®ã¿ï¼‰',
      pdf_one_desc: 'é¸æŠã—ãŸç”»åƒã®å…ˆé ­1æšã ã‘ã‚’1ãƒšãƒ¼ã‚¸PDFã¨ã—ã¦ä¿å­˜',
      pdf_merge_title: 'è¤‡æ•°ç”»åƒ â†’ 1ã¤ã®PDFã«çµåˆ',
      pdf_merge_desc: 'é¸æŠé †ã«PDFãƒšãƒ¼ã‚¸ã¨ã—ã¦çµåˆã—ã€1ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',

      img_zip_title: 'ZIPï¼ˆãŠã™ã™ã‚ï¼‰',
      img_zip_desc: 'è¤‡æ•°ç”»åƒã‚’ZIP 1ã¤ã«ã¾ã¨ã‚ã¦ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
      img_single_title: 'å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
      img_single_desc: '1æšãšã¤ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãŒè¤‡æ•°DLã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹å ´åˆã‚ã‚Šï¼‰',

      privacy_hint:
        'ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼: ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚<br/>' +
        'âœ… ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã—ã¾ã™ã€‚<br/>' +
        'ğŸ“¦ è¤‡æ•°ç”»åƒ: ZIP/å€‹åˆ¥ Â· ğŸ“„ PDF: çµåˆå¯èƒ½',

      msg_loading: 'ç”»åƒã‚’èª­ã¿è¾¼ã¿ä¸­â€¦',
      msg_ready_1: 'æº–å‚™å®Œäº†ï¼å¤‰æ›ãƒœã‚¿ãƒ³ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚',
      msg_ready_multi: (n) => `æº–å‚™å®Œäº†ï¼${n}æšé¸æŠã€‚å³å´ã§ZIP/å€‹åˆ¥ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚`,
      msg_png_q: 'PNGã¯ç„¡åŠ£åŒ–ã®ãŸã‚ã€å“è³ªè¨­å®šã¯é©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚',
      msg_pdf_note: 'PDFã¯å“è³ªè¨­å®šãŒé©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚',
      err_only_img: 'ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å¯¾å¿œã§ã™ã€‚',
      err_preview: 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚',
      err_upload_first: 'å…ˆã«ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚',
      converting: 'å¤‰æ›ä¸­â€¦',
      zipping: (n) => `${n}æšã‚’å¤‰æ›ä¸­â€¦ ZIPä½œæˆä¸­â€¦`,
      downloading_multi: (n) => `${n}æšã®å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹â€¦ï¼ˆãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹å ´åˆã‚ã‚Šï¼‰`,
      err_convert: 'å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸã€‚åˆ¥ã®è¨­å®šã§ãŠè©¦ã—ãã ã•ã„ã€‚',
      err_zip: 'ZIPä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚æšæ•°ã‚’æ¸›ã‚‰ã™ã‹å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',
      err_multi_blocked: 'ãƒ–ãƒ©ã‚¦ã‚¶ãŒè¤‡æ•°ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ZIPï¼ˆãŠã™ã™ã‚ï¼‰ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚',
      dl_start: (name, size) => `ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹: ${name} (${size})`,
      meta_tpl_single: (name, type, size, w, h) =>
        `ãƒ•ã‚¡ã‚¤ãƒ«å: <b>${name}</b><br/>å½¢å¼: <b>${type}</b><br/>ã‚µã‚¤ã‚º: <b>${size}</b><br/>è§£åƒåº¦: <b>${w} Ã— ${h}</b>`,
      meta_tpl_multi: (count, totalSize) =>
        `é¸æŠãƒ•ã‚¡ã‚¤ãƒ«: <b>${count}å€‹</b><br/>åˆè¨ˆå®¹é‡: <b>${totalSize}</b><br/>â€» ç”»åƒâ†’ZIP/å€‹åˆ¥ Â· PDFã¯çµåˆå¯èƒ½`,
      btn_up: 'ä¸Š',
      btn_down: 'ä¸‹',
      btn_del: 'å‰Šé™¤'
    }
  };

  const META_DESC = document.querySelector('meta[name="description"]');
  const OG_TITLE = document.querySelector('meta[property="og:title"]');
  const OG_DESC  = document.querySelector('meta[property="og:description"]');
  const TW_TITLE = document.querySelector('meta[name="twitter:title"]');
  const TW_DESC  = document.querySelector('meta[name="twitter:description"]');
  const JSONLD   = document.getElementById('jsonld');

  function detectLang(){
    const saved = localStorage.getItem("cf24_lang");
    if(saved && STR[saved]) return saved;

    const nav = (navigator.language || "").toLowerCase();
    if(nav.startsWith("ja")) return "ja";
    if(nav.startsWith("ko")) return "ko";
    if(nav.startsWith("es")) return "es";
    return "en";
  }
  let LANG = detectLang();

  function setActiveLangButtons(lang){
    document.querySelectorAll(".langbtn").forEach(b=>{
      b.classList.toggle("active", b.dataset.lang === lang);
    });
  }

  // =========================
  // State
  // =========================
  let files = [];            // [{file, url, w,h, imgEl}]
  let currentSingleIndex = 0; // which file to show in preview

  function humanSize(bytes){
    const units = ["B","KB","MB","GB"];
    let i = 0, v = bytes;
    while(v >= 1024 && i < units.length-1){ v/=1024; i++; }
    return `${v.toFixed(i===0?0:1)} ${units[i]}`;
  }
  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, (m)=>({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
    }[m]));
  }
  function setMessage(text, type){
    msg.textContent = text || "";
    msg.className = "msg " + (type || "");
  }

  function updateQualityState(){
    const mime = selFormat.value;
    const disableQuality = (mime === "image/png" || mime === "application/pdf");
    selQuality.disabled = disableQuality;
    selQuality.style.opacity = disableQuality ? ".6" : "1";
  }

  function selectedPdfMode(){
    const r = pdfModeRadios().find(x => x.checked);
    return r ? r.value : "single";
  }
  function selectedImgMode(){
    const r = imgModeRadios().find(x => x.checked);
    return r ? r.value : "zip";
  }

  function shouldShowModeBox(){
    return files.length > 0;
  }

  function renderTexts(){
    const t = STR[LANG];

    document.documentElement.lang = LANG;

    document.title = t.seoTitle;
    if(META_DESC) META_DESC.setAttribute("content", t.seoDesc);
    if(OG_TITLE)  OG_TITLE.setAttribute("content", t.ogTitle);
    if(OG_DESC)   OG_DESC.setAttribute("content", t.ogDesc);
    if(TW_TITLE)  TW_TITLE.setAttribute("content", t.ogTitle);
    if(TW_DESC)   TW_DESC.setAttribute("content", t.ogDesc);

    if(JSONLD){
      try{
        const obj = JSON.parse(JSONLD.textContent);
        obj.name = "ConvertFiles24";
        obj.url = (document.querySelector('link[rel="canonical"]')?.href) || obj.url;
        JSONLD.textContent = JSON.stringify(obj);
      }catch(e){}
    }

    $("subtitle").innerHTML = t.subtitle;
    $("h_upload").textContent = t.h_upload;
    $("drop_title").textContent = t.drop_title;
    $("pick_btn").textContent = t.pick_btn;
    $("drop_hint").textContent = t.drop_hint;

    $("h_preview").textContent = t.h_preview;
    $("h_settings").textContent = t.h_settings;
    $("lbl_format").textContent = t.lbl_format;
    $("lbl_quality").textContent = t.lbl_quality;

    $("q_095").textContent = t.q_095;
    $("q_090").textContent = t.q_090;
    $("q_080").textContent = t.q_080;
    $("q_070").textContent = t.q_070;

    $("lbl_w").textContent = t.lbl_w;
    $("lbl_h").textContent = t.lbl_h;
    inW.placeholder = t.ph_w;
    inH.placeholder = t.ph_h;
    $("size_hint").textContent = t.size_hint;

    $("h_download").textContent = t.h_download;
    btnConvert.textContent = t.convert;
    btnReset.textContent = t.reset;

    pagesTitle.textContent = t.pagesTitle;
    pagesHint.textContent = t.pagesHint;

    modeTitle.textContent = t.modeTitle;
    modeDesc.innerHTML = t.modeDesc;
    $("pdf_one_title").textContent = t.pdf_one_title;
    $("pdf_one_desc").textContent = t.pdf_one_desc;
    $("pdf_merge_title").textContent = t.pdf_merge_title;
    $("pdf_merge_desc").textContent = t.pdf_merge_desc;

    $("img_zip_title").textContent = t.img_zip_title;
    $("img_zip_desc").textContent = t.img_zip_desc;
    $("img_single_title").textContent = t.img_single_title;
    $("img_single_desc").textContent = t.img_single_desc;

    $("privacy_hint").innerHTML = t.privacy_hint;

    if(files.length === 0){
      meta.textContent = t.meta_idle;
      thumb.innerHTML = `<span style="color:#90a3c1; font-size:12px;">${t.thumb_label}</span>`;
    }
  }

  function setLang(lang){
    if(!STR[lang]) return;
    LANG = lang;
    localStorage.setItem("cf24_lang", lang);
    setActiveLangButtons(lang);
    renderTexts();
    renderPages();
    renderPreview();
    updateModeUI();
    updateConvertButtonState();
  }

  document.querySelectorAll(".langbtn").forEach(b=>{
    b.addEventListener("click", ()=> setLang(b.dataset.lang));
  });

  // =========================
  // Pages UI
  // =========================
  function renderPages(){
    if(files.length <= 1){
      pagesWrap.style.display = "none";
      return;
    }
    pagesWrap.style.display = "block";
    pagesSmall.textContent = STR[LANG].pagesSmall(files.length);

    pageList.innerHTML = "";
    files.forEach((it, idx) => {
      const item = document.createElement("div");
      item.className = "pageItem";

      const th = document.createElement("div");
      th.className = "pageThumb";
      const img = it.imgEl ? it.imgEl.cloneNode(true) : null;
      if(img){
        img.style.width = "100%";
        img.style.height = "100%";
        img.style.objectFit = "cover";
        th.appendChild(img);
      }else{
        th.innerHTML = '<span style="font-size:11px;color:#9fb0ca;">IMG</span>';
      }

      const info = document.createElement("div");
      info.className = "pageInfo";
      const name = document.createElement("div");
      name.className = "pageName";
      name.textContent = it.file.name;
      const mm = document.createElement("div");
      mm.className = "pageMeta";
      mm.textContent = `${humanSize(it.file.size)} Â· ${it.w}Ã—${it.h}`;
      info.appendChild(name);
      info.appendChild(mm);

      const btns = document.createElement("div");
      btns.className = "pageBtns";

      const up = document.createElement("button");
      up.className = "iconBtn";
      up.textContent = "â¬†ï¸";
      up.disabled = idx === 0;
      up.title = STR[LANG].btn_up;
      up.addEventListener("click", () => swap(idx, idx-1));

      const down = document.createElement("button");
      down.className = "iconBtn";
      down.textContent = "â¬‡ï¸";
      down.disabled = idx === files.length-1;
      down.title = STR[LANG].btn_down;
      down.addEventListener("click", () => swap(idx, idx+1));

      const del = document.createElement("button");
      del.className = "iconBtn";
      del.textContent = "ğŸ—‘ï¸";
      del.title = STR[LANG].btn_del;
      del.addEventListener("click", () => removeAt(idx));

      btns.appendChild(up);
      btns.appendChild(down);
      btns.appendChild(del);

      item.appendChild(th);
      item.appendChild(info);
      item.appendChild(btns);

      item.addEventListener("click", (e) => {
        if(e.target.closest("button")) return;
        currentSingleIndex = idx;
        renderPreview();
      });

      pageList.appendChild(item);
    });
  }

  function swap(i, j){
    if(i<0||j<0||i>=files.length||j>=files.length) return;
    const tmp = files[i];
    files[i] = files[j];
    files[j] = tmp;
    if(currentSingleIndex === i) currentSingleIndex = j;
    else if(currentSingleIndex === j) currentSingleIndex = i;

    renderPages();
    renderPreview();
    updateModeUI();
    updateConvertButtonState();
  }

  function removeAt(i){
    if(i<0 || i>=files.length) return;
    try{ URL.revokeObjectURL(files[i].url); }catch(e){}
    files.splice(i,1);
    if(currentSingleIndex >= files.length) currentSingleIndex = Math.max(0, files.length-1);

    renderPages();
    renderPreview();
    updateModeUI();
    updateConvertButtonState();
    if(files.length === 0) resetAll(false);
  }

  // =========================
  // Preview area
  // =========================
  function renderPreview(){
    const t = STR[LANG];
    if(files.length === 0){
      meta.textContent = t.meta_idle;
      thumb.innerHTML = `<span style="color:#90a3c1; font-size:12px;">${t.thumb_label}</span>`;
      return;
    }

    const idx = Math.min(currentSingleIndex, files.length-1);
    const it = files[idx];

    thumb.innerHTML = "";
    const img = it.imgEl ? it.imgEl.cloneNode(true) : null;
    if(img){
      img.style.width = "100%";
      img.style.height = "100%";
      img.style.objectFit = "cover";
      thumb.appendChild(img);
    }else{
      thumb.innerHTML = `<span style="color:#90a3c1; font-size:12px;">${t.thumb_label}</span>`;
    }

    if(files.length === 1){
      meta.innerHTML = t.meta_tpl_single(
        escapeHtml(it.file.name),
        escapeHtml(it.file.type || "unknown"),
        humanSize(it.file.size),
        it.w, it.h
      );
    } else {
      const total = files.reduce((s,x)=>s+x.file.size,0);
      meta.innerHTML = t.meta_tpl_multi(files.length, humanSize(total));
    }
  }

  // =========================
  // Mode UI (PDF vs Image)
  // =========================
  function updateModeUI(){
    if(!shouldShowModeBox()){
      modeBox.style.display = "none";
      return;
    }
    modeBox.style.display = "block";

    const isPDF = selFormat.value === "application/pdf";
    pdfModeRow.style.display = isPDF ? "flex" : "none";

    const imgModeRow = document.getElementById("imgModeRow");
    if(imgModeRow) imgModeRow.style.display = isPDF ? "none" : "flex";
  }

  function updateConvertButtonState(){
    btnConvert.disabled = (files.length === 0);
    btnReset.disabled = (files.length === 0);
  }

  // =========================
  // Load files
  // =========================
  async function loadFiles(fileList){
    if(!fileList || fileList.length === 0) return;

    resetAll(true);

    const arr = Array.from(fileList);
    for(const f of arr){
      if(!f.type.startsWith("image/")){
        setMessage(STR[LANG].err_only_img, "err");
        resetAll(false);
        return;
      }
    }

    setMessage(STR[LANG].msg_loading, "");

    for(const f of arr){
      const url = URL.createObjectURL(f);
      const img = new Image();
      const item = { file: f, url, w:0, h:0, imgEl:null };

      await new Promise((resolve) => {
        img.onload = () => {
          item.w = img.naturalWidth;
          item.h = img.naturalHeight;
          item.imgEl = img;
          resolve();
        };
        img.onerror = () => resolve();
        img.src = url;
      });

      if(!item.w || !item.h){
        try{ URL.revokeObjectURL(url); }catch(e){}
        setMessage(STR[LANG].err_preview, "err");
        resetAll(false);
        return;
      }

      files.push(item);
    }

    currentSingleIndex = 0;

    renderPages();
    renderPreview();
    updateModeUI();
    updateQualityState();
    updateConvertButtonState();

    if(files.length === 1){
      setMessage(STR[LANG].msg_ready_1, "ok");
    } else {
      setMessage(STR[LANG].msg_ready_multi(files.length), "ok");
    }
  }

  // =========================
  // Conversion helpers
  // =========================
  function getTargetSizeFor(baseW, baseH){
    const w = parseInt(inW.value, 10);
    const h = parseInt(inH.value, 10);

    if(!w && !h) return { w: baseW, h: baseH };
    if(w && !h) return { w, h: Math.round(w * (baseH / baseW)) };
    if(!w && h) return { w: Math.round(h * (baseW / baseH)), h };
    return { w, h };
  }

  function mimeToExt(mime){
    if(mime === "image/jpeg") return "jpg";
    if(mime === "image/png") return "png";
    if(mime === "image/webp") return "webp";
    if(mime === "application/pdf") return "pdf";
    return "bin";
  }

  function safeStamp(){
    return new Date().toISOString().replace(/[:.]/g,"-");
  }

  function downloadBlob(blob, filename){
    const a = document.createElement("a");
    const url = URL.createObjectURL(blob);
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 1500);
  }

  async function imageToBlob(imgEl, outMime, quality){
    const baseW = imgEl.naturalWidth;
    const baseH = imgEl.naturalHeight;
    const { w, h } = getTargetSizeFor(baseW, baseH);

    const canvas = document.createElement("canvas");
    canvas.width = w;
    canvas.height = h;
    const ctx = canvas.getContext("2d", { alpha: true });
    ctx.imageSmoothingEnabled = true;
    ctx.imageSmoothingQuality = "high";
    ctx.drawImage(imgEl, 0, 0, w, h);

    if(outMime === "image/png"){
      return await new Promise(res => canvas.toBlob(res, outMime));
    }
    return await new Promise(res => canvas.toBlob(res, outMime, quality));
  }

  async function imagesToMergedPdfBlob(imgItems){
    const { PDFDocument } = window.PDFLib;
    const pdfDoc = await PDFDocument.create();

    for(const it of imgItems){
      const imgEl = it.imgEl;
      const baseW = imgEl.naturalWidth;
      const baseH = imgEl.naturalHeight;
      const { w, h } = getTargetSizeFor(baseW, baseH);

      const canvas = document.createElement("canvas");
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext("2d", { alpha: true });
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = "high";
      ctx.drawImage(imgEl, 0, 0, w, h);

      const pngBlob = await new Promise(res => canvas.toBlob(res, "image/png"));
      if(!pngBlob) throw new Error("pngBlob failed");

      const pngBytes = new Uint8Array(await pngBlob.arrayBuffer());
      const embed = await pdfDoc.embedPng(pngBytes);

      const page = pdfDoc.addPage([w, h]);
      page.drawImage(embed, { x: 0, y: 0, width: w, height: h });
    }

    const pdfBytes = await pdfDoc.save();
    return new Blob([pdfBytes], { type: "application/pdf" });
  }

  async function imagesToZipBlob(imgItems, outMime, quality){
    const zip = new window.JSZip();
    const ext = mimeToExt(outMime);
    const stamp = safeStamp();

    let idx = 1;
    for(const it of imgItems){
      const base = (it.file.name || `image_${idx}`).replace(/\.[^.]+$/, "");
      const blob = await imageToBlob(it.imgEl, outMime, quality);
      if(!blob) throw new Error("toBlob failed");

      const filename = `${base}_${String(idx).padStart(2,"0")}_${stamp}.${ext}`;
      zip.file(filename, blob);
      idx++;
    }

    return await zip.generateAsync({ type: "blob" });
  }

  // =========================
  // Convert & Download
  // =========================
  async function convertAndDownload(){
    if(files.length === 0){
      setMessage(STR[LANG].err_upload_first, "err");
      return;
    }

    btnConvert.disabled = true;

    const outMime = selFormat.value;
    const quality = parseFloat(selQuality.value);

    try{
      // ===== PDF =====
      if(outMime === "application/pdf"){
        updateQualityState();
        setMessage(STR[LANG].converting, "");

        const mode = selectedPdfMode();
        let blob;

        if(mode === "single"){
          blob = await imagesToMergedPdfBlob([files[0]]);
        } else {
          blob = await imagesToMergedPdfBlob(files);
        }

        const name = (mode === "single" ? `image_${safeStamp()}.pdf` : `merged_${safeStamp()}.pdf`);
        downloadBlob(blob, name);
        setMessage(STR[LANG].dl_start(name, humanSize(blob.size)), "ok");
        btnConvert.disabled = false;
        return;
      }

      // ===== Images (JPG/PNG/WebP) =====
      updateQualityState();

      if(files.length === 1){
        setMessage(STR[LANG].converting, "");
        const it = files[0];
        const blob = await imageToBlob(it.imgEl, outMime, quality);
        if(!blob) throw new Error("convert failed");

        const base = (it.file.name || "image").replace(/\.[^.]+$/, "");
        const ext = mimeToExt(outMime);
        const name = `${base}_${safeStamp()}.${ext}`;

        downloadBlob(blob, name);
        setMessage(STR[LANG].dl_start(name, humanSize(blob.size)), "ok");
        btnConvert.disabled = false;
        return;
      }

      // Multiple images: ZIP or individual
      const imgMode = selectedImgMode();

      if(imgMode === "single"){
        setMessage(STR[LANG].downloading_multi(files.length), "");
        const ext = mimeToExt(outMime);
        const stamp = safeStamp();

        for(let i=0; i<files.length; i++){
          const it = files[i];
          const blob = await imageToBlob(it.imgEl, outMime, quality);
          if(!blob) throw new Error("convert failed");

          const base = (it.file.name || `image_${i+1}`).replace(/\.[^.]+$/, "");
          const name = `${base}_${String(i+1).padStart(2,"0")}_${stamp}.${ext}`;
          downloadBlob(blob, name);

          // ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œ í ê°„ê²© (ë„ˆë¬´ ë¹ ë¥´ë©´ ì°¨ë‹¨ë  ìˆ˜ ìˆìŒ)
          await new Promise(r => setTimeout(r, 280));
        }

        setMessage(STR[LANG].err_multi_blocked, ""); // ì•ˆë‚´ìš©
        btnConvert.disabled = false;
        return;
      }

      // ZIP
      setMessage(STR[LANG].zipping(files.length), "");
      const zipBlob = await imagesToZipBlob(files, outMime, quality);
      if(!zipBlob) throw new Error("zip failed");

      const ext = mimeToExt(outMime);
      const zipName = `images_${ext}_${safeStamp()}.zip`;
      downloadBlob(zipBlob, zipName);
      setMessage(STR[LANG].dl_start(zipName, humanSize(zipBlob.size)), "ok");
      btnConvert.disabled = false;

    }catch(e){
      console.error(e);
      if(outMime !== "application/pdf" && files.length > 1 && selectedImgMode() === "zip"){
        setMessage(STR[LANG].err_zip, "err");
      } else {
        setMessage(STR[LANG].err_convert, "err");
      }
      btnConvert.disabled = false;
    }
  }

  // =========================
  // Reset
  // =========================
  function resetAll(keepMessage){
    for(const it of files){
      try{ URL.revokeObjectURL(it.url); }catch(e){}
    }
    files = [];
    currentSingleIndex = 0;
    fileInput.value = "";
    inW.value = "";
    inH.value = "";
    btnConvert.disabled = true;
    btnReset.disabled = true;

    pagesWrap.style.display = "none";
    modeBox.style.display = "none";

    if(!keepMessage) setMessage("", "");
    renderTexts();
  }

  // =========================
  // Drag & drop (multi)
  // =========================
  ["dragenter","dragover"].forEach(evt => {
    drop.addEventListener(evt, (e) => {
      e.preventDefault();
      e.stopPropagation();
      drop.classList.add("drag");
    });
  });
  ["dragleave","drop"].forEach(evt => {
    drop.addEventListener(evt, (e) => {
      e.preventDefault();
      e.stopPropagation();
      drop.classList.remove("drag");
    });
  });
  drop.addEventListener("drop", (e) => {
    const fl = e.dataTransfer.files;
    if(fl && fl.length) loadFiles(fl);
  });

  fileInput.addEventListener("change", (e) => {
    const fl = e.target.files;
    if(fl && fl.length) loadFiles(fl);
  });

  btnConvert.addEventListener("click", convertAndDownload);
  btnReset.addEventListener("click", () => resetAll(false));

  selFormat.addEventListener("change", () => {
    updateQualityState();
    updateModeUI();

    const mime = selFormat.value;
    if(mime === "image/png"){
      setMessage(STR[LANG].msg_png_q, "");
    } else if(mime === "application/pdf"){
      setMessage(STR[LANG].msg_pdf_note, "");
    } else if(files.length > 1){
      setMessage(STR[LANG].msg_ready_multi(files.length), "ok");
    } else if(files.length === 1){
      setMessage(STR[LANG].msg_ready_1, "ok");
    } else {
      setMessage("", "");
    }
  });

  // init
  setLang(detectLang());
  resetAll(false);
})();
</script>
</body>
</html>