<!doctype html>
<html lang="en" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>ConvertFiles24 â€“ Free Converter (JPG, PNG, WebP, PDF, ZIP)</title>
  <meta name="description" content="Convert images (JPG/PNG/WebP) and merge PDFs â€” processed locally in your browser. Optional ZIP download." />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#0b0f17" />
  <link rel="canonical" href="https://convertfiles24.com/" />
<link rel="alternate" hreflang="en" href="https://convertfiles24.com/" />
<link rel="alternate" hreflang="es" href="https://convertfiles24.com/?lang=es" />
<link rel="alternate" hreflang="ja" href="https://convertfiles24.com/?lang=ja" />
<link rel="alternate" hreflang="ko" href="https://convertfiles24.com/?lang=ko" />
<link rel="alternate" hreflang="x-default" href="https://convertfiles24.com/" />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="ConvertFiles24 - Converter" />
  <meta property="og:description" content="Convert images and merge PDFs locally. Optional ZIP download." />
  <meta property="og:url" content="https://convertfiles24.com/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ConvertFiles24 - Converter" />
  <meta name="twitter:description" content="Convert images and merge PDFs locally. Optional ZIP download." />

  <script type="application/ld+json" id="jsonld">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"ConvertFiles24",
    "applicationCategory":"MultimediaApplication",
    "operatingSystem":"Web",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "url":"https://convertfiles24.com/"
  }
  </script>

  <!-- PDF & ZIP libraries (browser-local usage) -->
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <style>
    :root{
      --radius:16px;
      --pad:16px;
      --border:1px solid rgba(255,255,255,.12);
      --muted:#a7b3c7;
      --bg:#0b0f17;
      --fg:#e9eef7;
      --card:rgba(255,255,255,.03);
      --card2:rgba(255,255,255,.02);
      --blue:#2f6df6;
      --blue2:rgba(47,109,246,.22);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, Noto Sans KR, sans-serif;
      background:var(--bg);
      color:var(--fg);
      overflow-x:hidden; /* âœ… ê°€ë¡œ ë²—ì–´ë‚¨ ë°©ì§€ */
    }
    .wrap{ max-width:980px; margin:0 auto; padding:22px 14px 44px; width:100%; }

    .top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }
    @media (min-width: 720px){
      .top{ flex-wrap:nowrap; } /* âœ… PCì—ì„œ ì¼ë³¸ì–´ ëˆŒëŸ¬ë„ ì–¸ì–´ë°” ë‚´ë ¤ê°€ëŠ” í˜„ìƒ ë°©ì§€ */
    }
    .brand{ flex:1; min-width:240px; }
    h1{ margin:0; font-size:20px; letter-spacing:-.2px; }
    .sub{ margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.45; }

    /* âœ… language bar fix */
    .langbar{
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:flex-end;
      flex-wrap:nowrap;     /* âœ… ì¤„ë°”ê¿ˆ ë°©ì§€ */
      white-space:nowrap;   /* âœ… ì¤„ë°”ê¿ˆ ë°©ì§€ */
      flex:0 0 auto;
    }
    .langbtn{
      font-size:12px; font-weight:800;
      color:#b8c6dc;
      border:var(--border);
      padding:9px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.04);
      cursor:pointer;
      user-select:none;
      white-space:nowrap;   /* âœ… æ—¥æœ¬èª ì¤„ë°”ê¿ˆ ë°©ì§€ */
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .langbtn.active{
      color:var(--fg);
      background:var(--blue2);
      border-color:rgba(47,109,246,.55);
    }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:12px;
      width:100%;
    }
    @media (max-width: 860px){
      .grid{ grid-template-columns:1fr; }
    }

    .card{
      border:var(--border);
      background:var(--card);
      border-radius:var(--radius);
      padding:var(--pad);
      width:100%;
      overflow:hidden;
    }
    .card h2{ margin:0 0 10px; font-size:15px; color:#dbe7ff; }

    .drop{
      border:1px dashed rgba(255,255,255,.18);
      border-radius:14px;
      padding:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      background:var(--card2);
      width:100%;
    }
    .drop.drag{ background:rgba(106,169,255,.12); border-color:rgba(106,169,255,.45); }

    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      background:var(--blue);
      color:white;
      font-weight:800;
      padding:12px 14px;
      border-radius:14px;
      width:100%;
      font-size:15px;
    }
    .btn:disabled{ opacity:.45; cursor:not-allowed; }
    .btn.secondary{
      background:rgba(255,255,255,.10);
      color:var(--fg);
      border:var(--border);
    }
    .btn.small{
      width:auto;
      padding:10px 14px;
      font-size:14px;
      border-radius:14px;
    }

    .row{ display:flex; gap:10px; flex-wrap:wrap; width:100%; }
    .row > * { flex:1; min-width:160px; }

    label{ display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
    input[type="file"]{ display:none; }

    select, input[type="number"]{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      color:var(--fg);
      border:var(--border);
      outline:none;
    }
    /* â–¼ select / option ê°€ë…ì„± */
    select{ background-color:#0b0f17; color:#e9eef7; border:1px solid rgba(255,255,255,.2); }
    option{ background-color:#0b0f17; color:#e9eef7; }

    .preview{
      display:grid;
      grid-template-columns: 140px 1fr;
      gap:12px;
      align-items:center;
      width:100%;
    }
    @media (max-width: 520px){
      .preview{ grid-template-columns: 110px 1fr; }
    }

    .thumb{
      width:140px; height:140px;
      border-radius:14px;
      border:var(--border);
      background:rgba(255,255,255,.03);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    @media (max-width: 520px){
      .thumb{ width:110px; height:110px; }
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; }

    .meta{ color:#b7c3d9; font-size:13px; line-height:1.5; word-break:break-word; }
    .meta b{ color:var(--fg); }

    .hint{ margin-top:10px; color:#9fb0ca; font-size:12px; line-height:1.5; }
    .msg{ margin-top:10px; font-size:13px; color:#cfe0ff; }
    .err{ color:#ffb4b4; }
    .ok{ color:#b8ffcc; }
    .warn{ color:#ffd5a6; }

    .divider{ height:10px; }

    /* file list */
    .listWrap{
      margin-top:12px;
      border-top:1px solid rgba(255,255,255,.08);
      padding-top:12px;
    }
    .listTitle{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .listTitle .t1{ font-weight:800; }
    .listTitle .t2{ color:var(--muted); font-size:12px; line-height:1.3; }

    .fileItem{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      padding:10px;
      border:var(--border);
      border-radius:14px;
      background:rgba(255,255,255,.02);
      margin-top:8px;
      width:100%;
      overflow:hidden;
    }
    .fileLeft{
      display:flex;
      gap:10px;
      align-items:center;
      min-width:0;
      flex:1;
    }
    .miniThumb{
      width:44px; height:44px;
      border-radius:12px;
      border:var(--border);
      background:rgba(255,255,255,.03);
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      flex:0 0 auto;
    }
    .miniThumb img{ width:100%; height:100%; object-fit:cover; }
    .miniIcon{
      font-size:18px;
      opacity:.9;
    }
    .fileText{
      min-width:0;
      flex:1;
    }
    .fileName{
      font-weight:800;
      font-size:13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:100%;
    }
    .fileSub{
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .fileBtns{
      display:flex;
      gap:8px;
      flex:0 0 auto;
    }
    .iconBtn{
      width:44px;
      height:40px;
      border-radius:14px;
      border:var(--border);
      background:rgba(255,255,255,.06);
      color:var(--fg);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:16px;
      font-weight:900;
      user-select:none;
    }
    .iconBtn:disabled{
      opacity:.35;
      cursor:not-allowed;
    }

    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:9px 12px;
      border-radius:999px;
      border:var(--border);
      background:rgba(255,255,255,.04);
      color:var(--fg);
      font-size:12px;
      font-weight:800;
      user-select:none;
    }
    .pill input{ width:auto; }
    .foot{
      margin-top:14px;
      color:#94a6c2;
      font-size:12px;
      text-align:center;
    }

    .noteBox{
      margin-top:10px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.02);
      color:#b7c3d9;
      font-size:12px;
      line-height:1.55;
    }

    .toggleRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top:10px;
    }
    .toggleRow .left{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .toggleRow .right{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .selectMini{
      min-width:180px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <h1>ConvertFiles24</h1>
        <p class="sub" id="subtitle"></p>
      </div>

      <div class="langbar" aria-label="Language selector">
  <div class="langbtn" data-lang="en">ğŸ‡ºğŸ‡¸ EN</div>
  <div class="langbtn" data-lang="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</div>
  <div class="langbtn" data-lang="ko">ğŸ‡°ğŸ‡· KO</div>
  <div class="langbtn" data-lang="es">ğŸ‡ªğŸ‡¸ ES</div>
</div>
</div>

    <div class="grid">
      <!-- Left -->
      <div class="card">
        <h2 id="h_upload"></h2>

        <div class="drop" id="drop">
          <div style="width:100%;">
            <div style="font-weight:900; margin-bottom:8px;" id="drop_title"></div>

            <!-- âœ… ëª¨ë°”ì¼ íŒŒì¼ì„ íƒ íŠ¸ë¦¬ê±° ê°•í™”: ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ input.click() -->
            <button class="btn secondary small" id="pick_real_btn" type="button"></button>
            <input id="file" type="file" accept="image/*,application/pdf" multiple />

            <div class="hint" id="drop_hint"></div>

            <div class="noteBox" id="zip_pdf_note"></div>
          </div>
        </div>

        <div class="listWrap" id="listWrap" style="display:none;">
          <div class="listTitle">
            <div>
              <div class="t1" id="list_title"></div>
              <div class="t2" id="list_sub"></div>
            </div>
          </div>

          <div id="fileList"></div>
        </div>

        <div class="divider"></div>

        <h2 id="h_preview"></h2>
        <div class="preview">
          <div class="thumb" id="thumb"></div>
          <div class="meta" id="meta"></div>
        </div>

        <div class="msg" id="msg"></div>
      </div>

      <!-- Right -->
      <div class="card">
        <h2 id="h_settings"></h2>

        <div class="row">
          <div>
            <label id="lbl_format"></label>
            <select id="format">
              <option value="image/jpeg">JPG</option>
              <option value="image/png">PNG</option>
              <option value="image/webp">WebP</option>
              <option value="application/pdf">PDF</option>
            </select>
          </div>
          <div>
            <label id="lbl_quality"></label>
            <select id="quality">
              <option value="0.95" id="q_095"></option>
              <option value="0.9" selected id="q_090"></option>
              <option value="0.8" id="q_080"></option>
              <option value="0.7" id="q_070"></option>
            </select>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <div>
            <label id="lbl_w"></label>
            <input id="w" type="number" min="1" />
          </div>
          <div>
            <label id="lbl_h"></label>
            <input id="h" type="number" min="1" />
          </div>
        </div>

        <div class="hint" id="size_hint"></div>

        <div class="divider"></div>

        <!-- PDF options -->
        <div id="pdfBox" style="display:none;">
          <h2 id="h_pdf"></h2>

          <div class="row">
            <div>
              <label id="lbl_pdf_mode"></label>
              <select id="pdf_mode">
                <option value="single">Single-page PDF (first file)</option>
                <option value="images_merge">Images â†’ one PDF</option>
                <option value="pdf_merge">PDF + PDF merge</option>
                <option value="mixed_merge">Mixed (images + PDFs) â†’ one PDF</option>
              </select>
            </div>
            <div>
              <label id="lbl_pdf_skip_locked"></label>
              <select id="pdf_skip_locked">
                <option value="0">Stop if locked PDF found</option>
                <option value="1">Skip locked PDFs (recommended)</option>
              </select>
            </div>
          </div>

          <div class="divider"></div>

          <div class="toggleRow">
            <div class="left">
              <span class="pill">
                <input id="a4_on" type="checkbox" />
                <span id="lbl_a4"></span>
              </span>
            </div>
            <div class="right">
              <select id="a4_orient" class="selectMini">
                <option value="portrait">A4 Portrait</option>
                <option value="landscape">A4 Landscape</option>
              </select>
              <select id="a4_fit" class="selectMini">
                <option value="fit">Fit (no crop)</option>
                <option value="fill">Fill (may crop)</option>
              </select>
            </div>
          </div>

          <div class="hint" id="pdf_hint"></div>
          <div class="divider"></div>
        </div>

        <!-- ZIP option (for multiple outputs in image conversion) -->
        <div class="toggleRow" id="zipRow">
          <div class="left">
            <span class="pill">
              <input id="zip_on" type="checkbox" />
              <span id="lbl_zip"></span>
            </span>
          </div>
        </div>

        <div class="divider"></div>

        <h2 id="h_download"></h2>
        <button class="btn" id="convert" disabled></button>
        <div class="divider"></div>
        <button class="btn secondary" id="reset" disabled></button>

        <div class="hint" id="privacy_hint"></div>
      </div>
    </div>

    <div class="foot">
      Â© <span id="year"></span> ConvertFiles24 Â· Powered by GitHub Pages
    </div>
  </div>

<script>
(() => {
  const $ = (id) => document.getElementById(id);

  const fileInput = $("file");
  const pickBtn = $("pick_real_btn");
  const drop = $("drop");
  const thumb = $("thumb");
  const meta = $("meta");
  const msg = $("msg");
  const btnConvert = $("convert");
  const btnReset = $("reset");

  const selFormat = $("format");
  const selQuality = $("quality");
  const inW = $("w");
  const inH = $("h");

  const listWrap = $("listWrap");
  const fileListEl = $("fileList");

  const zipOn = $("zip_on");
  const zipRow = $("zipRow");

  const pdfBox = $("pdfBox");
  const pdfMode = $("pdf_mode");
  const pdfSkipLocked = $("pdf_skip_locked");
  const a4On = $("a4_on");
  const a4Orient = $("a4_orient");
  const a4Fit = $("a4_fit");

  $("year").textContent = new Date().getFullYear();

  // ===== i18n =====
  const STR = {
    ko: {
      seoTitle:"ConvertFiles24 - ë³€í™˜ê¸°",
      seoDesc:"ì´ë¯¸ì§€ ë³€í™˜(JPG/PNG/WebP) ë° PDF ë³‘í•© â€” ì„œë²„ ì—…ë¡œë“œ ì—†ì´ ë¸Œë¼ìš°ì €ì—ì„œ ë¡œì»¬ ì²˜ë¦¬. ZIP ë‹¤ìš´ë¡œë“œ ì˜µì…˜.",
      ogTitle:"ConvertFiles24 - ë³€í™˜ê¸°",
      ogDesc:"ì´ë¯¸ì§€ ë³€í™˜ + PDF ë³‘í•©ì„ ë¡œì»¬ì—ì„œ. ZIP ì˜µì…˜ ì§€ì›.",
      subtitle:'ì´ë¯¸ì§€ë¥¼ <b>JPG / PNG / WebP</b>ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ì—¬ëŸ¬ íŒŒì¼ì„ <b>PDFë¡œ í•©ì¹˜ê¸°</b> / <b>PDF+PDF ë³‘í•©</b>í•  ìˆ˜ ìˆì–´ìš”. (ì„œë²„ ì—…ë¡œë“œ ì—†ì´ ë¡œì»¬ ì²˜ë¦¬)',
      h_upload:"1) ì—…ë¡œë“œ",
      drop_title:"ì—¬ê¸°ì— íŒŒì¼ì„ ëŒì–´ë†“ê±°ë‚˜",
      pick_btn:"íŒŒì¼ ì„ íƒ",
      drop_hint:"ì§€ì›: JPG, PNG, WebP, PDF / ì—¬ëŸ¬ ì¥ ì„ íƒ ê°€ëŠ¥",
      zip_pdf_note:"â€¢ <b>ZIP</b>: ì—¬ëŸ¬ íŒŒì¼ ë³€í™˜ ê²°ê³¼ë¥¼ 1ê°œ ZIPìœ¼ë¡œ ë¬¶ì–´ì„œ ë‹¤ìš´ë¡œë“œ<br/>â€¢ <b>PDF</b>: ì—¬ëŸ¬ ì´ë¯¸ì§€/ì—¬ëŸ¬ PDFë¥¼ 1ê°œ PDFë¡œ í•©ì¹˜ê¸°",
      list_title:"í˜ì´ì§€ ìˆœì„œ / ì‚­ì œ",
      list_sub:"â†‘â†“ë¡œ ìˆœì„œ ë³€ê²½, ğŸ—‘ë¡œ ì‚­ì œ. (PDF ë³‘í•©ì€ ì´ ìˆœì„œë¥¼ ë”°ë¦…ë‹ˆë‹¤)",
      h_preview:"2) ë¯¸ë¦¬ë³´ê¸°",
      thumb_label:"ë¯¸ë¦¬ë³´ê¸°",
      meta_idle:"íŒŒì¼ì„ ì„ íƒí•˜ë©´ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.",
      h_settings:"3) ë³€í™˜ ì„¤ì •",
      lbl_format:"ì¶œë ¥ í˜•ì‹",
      lbl_quality:"í’ˆì§ˆ (JPG/WebPë§Œ)",
      q_095:"ìµœê³ (0.95)",
      q_090:"ë†’ìŒ(0.90)",
      q_080:"ë³´í†µ(0.80)",
      q_070:"ì••ì¶•(0.70)",
      lbl_w:"ê°€ë¡œ(px) (ë¹„ìš°ë©´ ì›ë³¸)",
      lbl_h:"ì„¸ë¡œ(px) (ë¹„ìš°ë©´ ì›ë³¸)",
      ph_w:"ì˜ˆ: 1200",
      ph_h:"ì˜ˆ: 800",
      size_hint:"ê°€ë¡œ/ì„¸ë¡œ í•˜ë‚˜ë§Œ ì…ë ¥í•˜ë©´ ë¹„ìœ¨ ìœ ì§€ë¡œ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.",
      h_pdf:"PDF ì˜µì…˜",
      lbl_pdf_mode:"PDF ëª¨ë“œ",
      lbl_pdf_skip_locked:"ì•”í˜¸/ê¶Œí•œ PDF",
      lbl_a4:"A4ë¡œ í†µì¼",
      pdf_hint:"A4 í†µì¼ì„ ì¼œë©´ í˜ì´ì§€ í¬ê¸°ë¥¼ A4ë¡œ ë§ì¶”ê³ (ê¶Œì¥: Fit), ì¶œë ¥/ì œì¶œì— ê¹”ë”í•©ë‹ˆë‹¤.",
      lbl_zip:"ì—¬ëŸ¬ ê²°ê³¼ ZIPë¡œ ë¬¶ê¸°",
      h_download:"4) ë‹¤ìš´ë¡œë“œ",
      convert:"ë³€í™˜ & ë‹¤ìš´ë¡œë“œ",
      reset:"ì´ˆê¸°í™”",
      privacy_hint:"ğŸ”’ ê°œì¸ì •ë³´: ì—…ë¡œë“œëœ íŒŒì¼ì€ ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br/>âœ… JPG/PNG/WebP/PDF ë³€í™˜ ë° PDF ë³‘í•©ì€ ë¸Œë¼ìš°ì €ì—ì„œ ë¡œì»¬ ì²˜ë¦¬ë©ë‹ˆë‹¤.",
      msg_loading:"ë¡œë”© ì¤‘â€¦",
      msg_ready:(n)=>`ì¤€ë¹„ ì™„ë£Œ! (${n}ê°œ ì„ íƒë¨)`,
      msg_png_q:"PNGëŠ” ë¬´ì†ì‹¤ì´ë¼ í’ˆì§ˆ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì•„ìš”.",
      msg_pdf_q:"PDFëŠ” í’ˆì§ˆ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì•„ìš”.",
      err_none:"ë¨¼ì € íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.",
      err_only_img_pdf:"ì´ë¯¸ì§€ ë˜ëŠ” PDFë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.",
      err_process:"íŒŒì¼ì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ì–´ìš”. ë‹¤ë¥¸ íŒŒì¼ë¡œ ì‹œë„í•´ ì£¼ì„¸ìš”.",
      err_preview:"ë¯¸ë¦¬ë³´ê¸°ì— ì‹¤íŒ¨í–ˆì–´ìš”.",
      converting:"ë³€í™˜ ì¤‘â€¦",
      err_convert:"ë³€í™˜ ì‹¤íŒ¨. ë‹¤ë¥¸ ì˜µì…˜ìœ¼ë¡œ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",
      warn_multi_zip:"ì—¬ëŸ¬ ì¥ì„ ì´ë¯¸ì§€ë¡œ ê°ê° ë°›ìœ¼ë ¤ë©´ ZIPì„ ì¼œ ì£¼ì„¸ìš”.",
      warn_pdf_locked:(name)=>`ğŸ”’ ì•”í˜¸/ê¶Œí•œ ì œí•œ PDFë¡œ ë³´ì…ë‹ˆë‹¤: ${name} (ì ê¸ˆ í•´ì œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜, 'ìŠ¤í‚µ' ì˜µì…˜ì„ ì‚¬ìš©í•˜ì„¸ìš”)`,
      warn_pdf_skip:(name)=>`âš ï¸ ì ê¸´ PDFëŠ” ê±´ë„ˆëœë‹ˆë‹¤: ${name}`,
      ok_zip_done:(name)=>`ZIP ë‹¤ìš´ë¡œë“œ ì‹œì‘: ${name}`,
      ok_done:(name)=>`ë‹¤ìš´ë¡œë“œ ì‹œì‘: ${name}`,
      meta_tpl:(name,type,size,extra)=>`íŒŒì¼ëª…: <b>${name}</b><br/>í˜•ì‹: <b>${type}</b><br/>í¬ê¸°: <b>${size}</b>${extra?("<br/>"+extra):""}`,
      extra_img:(w,h)=>`í•´ìƒë„: <b>${w} Ã— ${h}</b>`,
      extra_pdf:(pages)=>`PDF í˜ì´ì§€: <b>${pages}</b>`,
      pdf_mode_labels:{
        single:"1ì¥ PDF (ì²« íŒŒì¼ 1ê°œ)",
        images_merge:"ì—¬ëŸ¬ ì´ë¯¸ì§€ â†’ í•œ PDFë¡œ í•©ì¹˜ê¸°",
        pdf_merge:"PDF + PDF í•©ì¹˜ê¸°",
        mixed_merge:"ì´ë¯¸ì§€ + PDF â†’ í•œ PDFë¡œ í•©ì¹˜ê¸°"
      },
      locked_stop:"ì ê¸´ PDF ë°œê²¬ ì‹œ ì¤‘ë‹¨",
      locked_skip:"ì ê¸´ PDFëŠ” ê±´ë„ˆë›°ê¸°(ì¶”ì²œ)",
      a4_portrait:"A4 ì„¸ë¡œ",
      a4_landscape:"A4 ê°€ë¡œ",
      fit:"Fit(ì•ˆ ì˜ë¦¼/ì—¬ë°± ê°€ëŠ¥)",
      fill:"Fill(ê½‰ ì±„ì›€/ì˜ë¦´ ìˆ˜ ìˆìŒ)"
    },
    en: {
      seoTitle:"ConvertFiles24 - Converter",
      seoDesc:"Convert images (JPG/PNG/WebP) and merge PDFs â€” processed locally in your browser. Optional ZIP download.",
      ogTitle:"ConvertFiles24 - Converter",
      ogDesc:"Convert images + merge PDFs locally. ZIP option supported.",
      subtitle:'Convert images to <b>JPG / PNG / WebP</b>, or merge into <b>PDF</b> / <b>PDF+PDF merge</b>. (Processed locally in your browser)',
      h_upload:"1) Upload",
      drop_title:"Drag & drop files here, or",
      pick_btn:"Choose files",
      drop_hint:"Supports JPG, PNG, WebP, PDF / Multiple selection supported",
      zip_pdf_note:"â€¢ <b>ZIP</b>: Bundle multiple converted files into one ZIP<br/>â€¢ <b>PDF</b>: Merge multiple images/PDFs into one PDF",
      list_title:"Page order / delete",
      list_sub:"Use â†‘â†“ to reorder, ğŸ—‘ to delete. (PDF merge follows this order)",
      h_preview:"2) Preview",
      thumb_label:"Preview",
      meta_idle:"Select files to see details.",
      h_settings:"3) Conversion settings",
      lbl_format:"Output format",
      lbl_quality:"Quality (JPG/WebP only)",
      q_095:"Max (0.95)",
      q_090:"High (0.90)",
      q_080:"Normal (0.80)",
      q_070:"Small (0.70)",
      lbl_w:"Width (px) (blank = original)",
      lbl_h:"Height (px) (blank = original)",
      ph_w:"e.g., 1200",
      ph_h:"e.g., 800",
      size_hint:"If you enter only one side, the aspect ratio is preserved automatically.",
      h_pdf:"PDF options",
      lbl_pdf_mode:"PDF mode",
      lbl_pdf_skip_locked:"Locked PDFs",
      lbl_a4:"Normalize to A4",
      pdf_hint:"If A4 is ON, pages become A4 (recommended: Fit) for clean printing/submission.",
      lbl_zip:"Bundle multiple outputs into ZIP",
      h_download:"4) Download",
      convert:"Convert & Download",
      reset:"Reset",
      privacy_hint:"ğŸ”’ Privacy: Your files are never uploaded to a server.<br/>âœ… Image conversion & PDF merge run locally in your browser.",
      msg_loading:"Loadingâ€¦",
      msg_ready:(n)=>`Ready! (${n} selected)`,
      msg_png_q:"PNG is lossless, so quality setting doesnâ€™t apply.",
      msg_pdf_q:"Quality doesnâ€™t apply to PDF.",
      err_none:"Please select files first.",
      err_only_img_pdf:"Images or PDFs only.",
      err_process:"Could not process the file. Try a different file.",
      err_preview:"Failed to preview.",
      converting:"Convertingâ€¦",
      err_convert:"Conversion failed. Try different options.",
      warn_multi_zip:"To download multiple image results, enable ZIP.",
      warn_pdf_locked:(name)=>`ğŸ”’ This PDF looks locked/restricted: ${name} (unlock it and retry, or use 'skip' option)`,
      warn_pdf_skip:(name)=>`âš ï¸ Skipping locked PDF: ${name}`,
      ok_zip_done:(name)=>`ZIP download started: ${name}`,
      ok_done:(name)=>`Download started: ${name}`,
      meta_tpl:(name,type,size,extra)=>`Name: <b>${name}</b><br/>Type: <b>${type}</b><br/>Size: <b>${size}</b>${extra?("<br/>"+extra):""}`,
      extra_img:(w,h)=>`Resolution: <b>${w} Ã— ${h}</b>`,
      extra_pdf:(pages)=>`PDF pages: <b>${pages}</b>`,
      pdf_mode_labels:{
        single:"Single-page PDF (first file)",
        images_merge:"Images â†’ one PDF",
        pdf_merge:"PDF + PDF merge",
        mixed_merge:"Mixed (images + PDFs) â†’ one PDF"
      },
      locked_stop:"Stop if locked PDF found",
      locked_skip:"Skip locked PDFs (recommended)",
      a4_portrait:"A4 Portrait",
      a4_landscape:"A4 Landscape",
      fit:"Fit (no crop)",
      fill:"Fill (may crop)"
    },
    ja: {
      seoTitle:"ConvertFiles24 - å¤‰æ›",
      seoDesc:"ç”»åƒå¤‰æ›(JPG/PNG/WebP)ã¨PDFçµåˆ â€” ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã€‚ZIPã‚ªãƒ—ã‚·ãƒ§ãƒ³å¯¾å¿œã€‚",
      ogTitle:"ConvertFiles24 - å¤‰æ›",
      ogDesc:"ç”»åƒå¤‰æ› + PDFçµåˆã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ã€‚ZIPã‚ªãƒ—ã‚·ãƒ§ãƒ³å¯¾å¿œã€‚",
      subtitle:'ç”»åƒã‚’ <b>JPG / PNG / WebP</b> ã«å¤‰æ›ã€ã¾ãŸã¯ <b>PDFçµåˆ</b> / <b>PDF+PDFçµåˆ</b>ã€‚ï¼ˆã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ï¼‰',
      h_upload:"1) ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
      drop_title:"ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯",
      pick_btn:"ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ",
      drop_hint:"å¯¾å¿œ: JPG, PNG, WebP, PDF / è¤‡æ•°é¸æŠOK",
      zip_pdf_note:"â€¢ <b>ZIP</b>: è¤‡æ•°ã®å¤‰æ›çµæœã‚’1ã¤ã®ZIPã«ã¾ã¨ã‚ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰<br/>â€¢ <b>PDF</b>: è¤‡æ•°ç”»åƒ/è¤‡æ•°PDFã‚’1ã¤ã®PDFã«çµåˆ",
      list_title:"é †åº / å‰Šé™¤",
      list_sub:"â†‘â†“ã§é †åºå¤‰æ›´ã€ğŸ—‘ã§å‰Šé™¤ã€‚ï¼ˆPDFçµåˆã¯ã“ã®é †åºï¼‰",
      h_preview:"2) ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼",
      thumb_label:"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼",
      meta_idle:"ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã™ã‚‹ã¨æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚",
      h_settings:"3) å¤‰æ›è¨­å®š",
      lbl_format:"å‡ºåŠ›å½¢å¼",
      lbl_quality:"å“è³ªï¼ˆJPG/WebPã®ã¿ï¼‰",
      q_095:"æœ€é«˜(0.95)",
      q_090:"é«˜(0.90)",
      q_080:"æ¨™æº–(0.80)",
      q_070:"åœ§ç¸®(0.70)",
      lbl_w:"å¹…(px)ï¼ˆç©ºæ¬„=å…ƒã‚µã‚¤ã‚ºï¼‰",
      lbl_h:"é«˜ã•(px)ï¼ˆç©ºæ¬„=å…ƒã‚µã‚¤ã‚ºï¼‰",
      ph_w:"ä¾‹: 1200",
      ph_h:"ä¾‹: 800",
      size_hint:"ç‰‡æ–¹ã ã‘å…¥åŠ›ã™ã‚‹ã¨ã€æ¯”ç‡ã‚’ç¶­æŒã—ã¦è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚",
      h_pdf:"PDFã‚ªãƒ—ã‚·ãƒ§ãƒ³",
      lbl_pdf_mode:"PDFãƒ¢ãƒ¼ãƒ‰",
      lbl_pdf_skip_locked:"ãƒ­ãƒƒã‚¯PDF",
      lbl_a4:"A4ã«çµ±ä¸€",
      pdf_hint:"A4ã‚’ONã«ã™ã‚‹ã¨ãƒšãƒ¼ã‚¸ãŒA4ã«ãªã‚Šã¾ã™ï¼ˆæ¨å¥¨: Fitï¼‰ã€‚å°åˆ·/æå‡ºã«ãã‚Œã„ã§ã™ã€‚",
      lbl_zip:"è¤‡æ•°çµæœã‚’ZIPã«ã¾ã¨ã‚ã‚‹",
      h_download:"4) ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
      convert:"å¤‰æ›ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
      reset:"ãƒªã‚»ãƒƒãƒˆ",
      privacy_hint:"ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼: ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚<br/>âœ… å¤‰æ›ã¨PDFçµåˆã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã§ã™ã€‚",
      msg_loading:"èª­ã¿è¾¼ã¿ä¸­â€¦",
      msg_ready:(n)=>`æº–å‚™å®Œäº†ï¼ï¼ˆ${n}ä»¶é¸æŠï¼‰`,
      msg_png_q:"PNGã¯ç„¡åŠ£åŒ–ã®ãŸã‚ã€å“è³ªè¨­å®šã¯é©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚",
      msg_pdf_q:"PDFã«ã¯å“è³ªè¨­å®šãŒé©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚",
      err_none:"å…ˆã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚",
      err_only_img_pdf:"ç”»åƒã¾ãŸã¯PDFã®ã¿å¯¾å¿œã§ã™ã€‚",
      err_process:"å‡¦ç†ã§ãã¾ã›ã‚“ã€‚åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ãŠè©¦ã—ãã ã•ã„ã€‚",
      err_preview:"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
      converting:"å¤‰æ›ä¸­â€¦",
      err_convert:"å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸã€‚åˆ¥ã®è¨­å®šã§ãŠè©¦ã—ãã ã•ã„ã€‚",
      warn_multi_zip:"è¤‡æ•°ç”»åƒã®çµæœã‚’ã¾ã¨ã‚ã¦å—ã‘å–ã‚‹ã«ã¯ZIPã‚’ONã«ã—ã¦ãã ã•ã„ã€‚",
      warn_pdf_locked:(name)=>`ğŸ”’ ãƒ­ãƒƒã‚¯/æ¨©é™åˆ¶é™ã®PDFã®å¯èƒ½æ€§: ${name}ï¼ˆè§£é™¤ã—ã¦å†è©¦è¡Œã€ã¾ãŸã¯ã‚¹ã‚­ãƒƒãƒ—ã‚’ä½¿ç”¨ï¼‰`,
      warn_pdf_skip:(name)=>`âš ï¸ ãƒ­ãƒƒã‚¯PDFã‚’ã‚¹ã‚­ãƒƒãƒ—: ${name}`,
      ok_zip_done:(name)=>`ZIPãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹: ${name}`,
      ok_done:(name)=>`ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹: ${name}`,
      meta_tpl:(name,type,size,extra)=>`ãƒ•ã‚¡ã‚¤ãƒ«å: <b>${name}</b><br/>å½¢å¼: <b>${type}</b><br/>ã‚µã‚¤ã‚º: <b>${size}</b>${extra?("<br/>"+extra):""}`,
      extra_img:(w,h)=>`è§£åƒåº¦: <b>${w} Ã— ${h}</b>`,
      extra_pdf:(pages)=>`PDFãƒšãƒ¼ã‚¸: <b>${pages}</b>`,
      pdf_mode_labels:{
        single:"1ãƒšãƒ¼ã‚¸PDFï¼ˆå…ˆé ­1ä»¶ï¼‰",
        images_merge:"è¤‡æ•°ç”»åƒ â†’ 1PDF",
        pdf_merge:"PDF+PDF çµåˆ",
        mixed_merge:"ç”»åƒ+PDF â†’ 1PDF"
      },
      locked_stop:"ãƒ­ãƒƒã‚¯PDFãŒã‚ã‚Œã°åœæ­¢",
      locked_skip:"ãƒ­ãƒƒã‚¯PDFã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰",
      a4_portrait:"A4 ç¸¦",
      a4_landscape:"A4 æ¨ª",
      fit:"Fitï¼ˆåˆ‡ã‚Œãªã„ï¼‰",
      fill:"Fillï¼ˆåˆ‡ã‚Œã‚‹å¯èƒ½æ€§ï¼‰"
    },
    es: {
      seoTitle:"ConvertFiles24 - Convertidor",
      seoDesc:"Convierte imÃ¡genes (JPG/PNG/WebP) y une PDFs â€” todo local en tu navegador. OpciÃ³n ZIP.",
      ogTitle:"ConvertFiles24 - Convertidor",
      ogDesc:"Convierte imÃ¡genes + une PDFs localmente. OpciÃ³n ZIP disponible.",
      subtitle:'Convierte imÃ¡genes a <b>JPG / PNG / WebP</b>, o une en <b>PDF</b> / <b>PDF+PDF merge</b>. (Procesado localmente en tu navegador)',
      h_upload:"1) Subir",
      drop_title:"Arrastra y suelta archivos aquÃ­, o",
      pick_btn:"Elegir archivos",
      drop_hint:"Soporta JPG, PNG, WebP, PDF / SelecciÃ³n mÃºltiple",
      zip_pdf_note:"â€¢ <b>ZIP</b>: Agrupa varios resultados en un solo ZIP<br/>â€¢ <b>PDF</b>: Une varias imÃ¡genes/PDFs en un solo PDF",
      list_title:"Orden / borrar",
      list_sub:"Usa â†‘â†“ para reordenar, ğŸ—‘ para borrar. (La uniÃ³n PDF sigue este orden)",
      h_preview:"2) Vista previa",
      thumb_label:"Vista previa",
      meta_idle:"Selecciona archivos para ver detalles.",
      h_settings:"3) ConfiguraciÃ³n",
      lbl_format:"Formato de salida",
      lbl_quality:"Calidad (solo JPG/WebP)",
      q_095:"MÃ¡x (0.95)",
      q_090:"Alta (0.90)",
      q_080:"Normal (0.80)",
      q_070:"PequeÃ±a (0.70)",
      lbl_w:"Ancho (px) (vacÃ­o = original)",
      lbl_h:"Alto (px) (vacÃ­o = original)",
      ph_w:"ej., 1200",
      ph_h:"ej., 800",
      size_hint:"Si ingresas solo un lado, se mantiene la proporciÃ³n automÃ¡ticamente.",
      h_pdf:"Opciones PDF",
      lbl_pdf_mode:"Modo PDF",
      lbl_pdf_skip_locked:"PDFs bloqueados",
      lbl_a4:"Normalizar a A4",
      pdf_hint:"Con A4 activado, las pÃ¡ginas serÃ¡n A4 (recomendado: Fit) para impresiÃ³n/entrega limpia.",
      lbl_zip:"Agrupar mÃºltiples salidas en ZIP",
      h_download:"4) Descargar",
      convert:"Convertir y descargar",
      reset:"Reiniciar",
      privacy_hint:"ğŸ”’ Privacidad: Tus archivos nunca se suben a un servidor.<br/>âœ… La conversiÃ³n y la uniÃ³n PDF se ejecutan localmente en tu navegador.",
      msg_loading:"Cargandoâ€¦",
      msg_ready:(n)=>`Â¡Listo! (${n} seleccionados)`,
      msg_png_q:"PNG es sin pÃ©rdida, por lo que la calidad no aplica.",
      msg_pdf_q:"La calidad no aplica a PDF.",
      err_none:"Primero selecciona archivos.",
      err_only_img_pdf:"Solo imÃ¡genes o PDFs.",
      err_process:"No se pudo procesar. Prueba otro archivo.",
      err_preview:"Error en vista previa.",
      converting:"Convirtiendoâ€¦",
      err_convert:"FallÃ³ la conversiÃ³n. Prueba otras opciones.",
      warn_multi_zip:"Para descargar mÃºltiples resultados de imÃ¡genes, activa ZIP.",
      warn_pdf_locked:(name)=>`ğŸ”’ Este PDF parece bloqueado/restringido: ${name} (desbloquÃ©alo o usa 'omitir')`,
      warn_pdf_skip:(name)=>`âš ï¸ Omitiendo PDF bloqueado: ${name}`,
      ok_zip_done:(name)=>`Descarga ZIP iniciada: ${name}`,
      ok_done:(name)=>`Descarga iniciada: ${name}`,
      meta_tpl:(name,type,size,extra)=>`Nombre: <b>${name}</b><br/>Tipo: <b>${type}</b><br/>TamaÃ±o: <b>${size}</b>${extra?("<br/>"+extra):""}`,
      extra_img:(w,h)=>`ResoluciÃ³n: <b>${w} Ã— ${h}</b>`,
      extra_pdf:(pages)=>`PÃ¡ginas PDF: <b>${pages}</b>`,
      pdf_mode_labels:{
        single:"PDF de 1 pÃ¡gina (primer archivo)",
        images_merge:"ImÃ¡genes â†’ un PDF",
        pdf_merge:"Unir PDF + PDF",
        mixed_merge:"Mixto (imÃ¡genes + PDFs) â†’ un PDF"
      },
      locked_stop:"Detener si hay PDF bloqueado",
      locked_skip:"Omitir PDFs bloqueados (recomendado)",
      a4_portrait:"A4 Vertical",
      a4_landscape:"A4 Horizontal",
      fit:"Fit (sin recorte)",
      fill:"Fill (puede recortar)"
    }
  };

  const META_DESC = document.querySelector('meta[name="description"]');
  const OG_TITLE = document.querySelector('meta[property="og:title"]');
  const OG_DESC  = document.querySelector('meta[property="og:description"]');
  const TW_TITLE = document.querySelector('meta[name="twitter:title"]');
  const TW_DESC  = document.querySelector('meta[name="twitter:description"]');
  const JSONLD   = $("jsonld");

  function detectLang(){
    const saved = localStorage.getItem("cf24_lang");
    if(saved && STR[saved]) return saved;
    const nav = (navigator.language || "").toLowerCase();
    if(nav.startsWith("ja")) return "ja";
    if(nav.startsWith("ko")) return "ko";
    if(nav.startsWith("es")) return "es";
    return "en";
  }
  let LANG = detectLang();

  function setActiveLangButtons(lang){
    document.querySelectorAll(".langbtn").forEach(b=>{
      b.classList.toggle("active", b.dataset.lang === lang);
    });
  }

  function setMessage(text, type){
    msg.textContent = text || "";
    msg.className = "msg " + (type || "");
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, (m)=>({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
    }[m]));
  }
  function humanSize(bytes){
    const units = ["B","KB","MB","GB"];
    let i=0, v=bytes;
    while(v>=1024 && i<units.length-1){ v/=1024; i++; }
    return `${v.toFixed(i===0?0:1)} ${units[i]}`;
  }

  function renderTexts(){
    const t = STR[LANG];
    document.documentElement.lang = LANG;

    document.title = t.seoTitle;
    if(META_DESC) META_DESC.setAttribute("content", t.seoDesc);
    if(OG_TITLE)  OG_TITLE.setAttribute("content", t.ogTitle);
    if(OG_DESC)   OG_DESC.setAttribute("content", t.ogDesc);
    if(TW_TITLE)  TW_TITLE.setAttribute("content", t.ogTitle);
    if(TW_DESC)   TW_DESC.setAttribute("content", t.ogDesc);

    if(JSONLD){
      try{
        const obj = JSON.parse(JSONLD.textContent);
        obj.url = (document.querySelector('link[rel="canonical"]')?.href) || obj.url;
        JSONLD.textContent = JSON.stringify(obj);
      }catch(e){}
    }

    $("subtitle").innerHTML = t.subtitle;

    $("h_upload").textContent = t.h_upload;
    $("drop_title").textContent = t.drop_title;
    pickBtn.textContent = t.pick_btn;
    $("drop_hint").textContent = t.drop_hint;
    $("zip_pdf_note").innerHTML = t.zip_pdf_note;

    $("list_title").textContent = t.list_title;
    $("list_sub").textContent = t.list_sub;

    $("h_preview").textContent = t.h_preview;
    $("h_settings").textContent = t.h_settings;

    $("lbl_format").textContent = t.lbl_format;
    $("lbl_quality").textContent = t.lbl_quality;
    $("q_095").textContent = t.q_095;
    $("q_090").textContent = t.q_090;
    $("q_080").textContent = t.q_080;
    $("q_070").textContent = t.q_070;

    $("lbl_w").textContent = t.lbl_w;
    $("lbl_h").textContent = t.lbl_h;
    inW.placeholder = t.ph_w;
    inH.placeholder = t.ph_h;
    $("size_hint").textContent = t.size_hint;

    $("h_pdf").textContent = t.h_pdf;
    $("lbl_pdf_mode").textContent = t.lbl_pdf_mode;
    $("lbl_pdf_skip_locked").textContent = t.lbl_pdf_skip_locked;
    $("lbl_a4").textContent = t.lbl_a4;
    $("pdf_hint").textContent = t.pdf_hint;

    // PDF mode labels
    [...pdfMode.options].forEach(opt=>{
      opt.textContent = t.pdf_mode_labels[opt.value] || opt.textContent;
    });
    pdfSkipLocked.options[0].textContent = t.locked_stop;
    pdfSkipLocked.options[1].textContent = t.locked_skip;

    a4Orient.options[0].textContent = t.a4_portrait;
    a4Orient.options[1].textContent = t.a4_landscape;
    a4Fit.options[0].textContent = t.fit;
    a4Fit.options[1].textContent = t.fill;

    $("lbl_zip").textContent = t.lbl_zip;

    $("h_download").textContent = t.h_download;
    btnConvert.textContent = t.convert;
    btnReset.textContent = t.reset;
    $("privacy_hint").innerHTML = t.privacy_hint;

    if(files.length === 0){
      meta.textContent = t.meta_idle;
      thumb.innerHTML = `<span style="color:#90a3c1; font-size:12px;">${t.thumb_label}</span>`;
    }
  }

  function setLang(lang){
    if(!STR[lang]) return;
    LANG = lang;
    localStorage.setItem("cf24_lang", lang);
    setActiveLangButtons(lang);
    renderTexts();
    refreshUIState();
    renderFileList();
    renderPreviewMeta();
  }

  document.querySelectorAll(".langbtn").forEach(b=>{
    b.addEventListener("click", ()=> setLang(b.dataset.lang));
  });

  // ===== App state =====
  /**
   * files: { id, file, kind:'image'|'pdf', name, type, size, imgW?, imgH?, pdfPages?, lockedPdf? }
   */
  let files = [];
  let currentIndex = 0; // preview index
  let busy = false;

  // ===== Helpers =====
  function nowStamp(){
    return new Date().toISOString().replace(/[:.]/g,"-");
  }
  function mimeToExt(m){
    if(m === "image/jpeg") return "jpg";
    if(m === "image/png") return "png";
    if(m === "image/webp") return "webp";
    if(m === "application/pdf") return "pdf";
    return "bin";
  }
  function baseName(name){
    return (name || "file").replace(/\.[^.]+$/,"");
  }
  function downloadBlob(blob, filename){
    const a = document.createElement("a");
    const url = URL.createObjectURL(blob);
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 1500);
  }

  // ===== UI logic =====
  function refreshUIState(){
    const t = STR[LANG];
    const hasAny = files.length > 0;
    btnReset.disabled = !hasAny;
    btnConvert.disabled = !hasAny || busy;

    // PDF box visible only if output is PDF
    const isPdfOut = selFormat.value === "application/pdf";
    pdfBox.style.display = isPdfOut ? "block" : "none";

    // Quality disabled for PNG/PDF
    const disableQ = (selFormat.value === "image/png" || selFormat.value === "application/pdf");
    selQuality.disabled = disableQ;
    selQuality.style.opacity = disableQ ? ".6" : "1";

    // ZIP row:
    // - Useful when output is image formats AND multiple files (each -> converted file)
    // - For PDF output, ZIP not needed (PDF result is single file). Hide on PDF output.
    zipRow.style.display = isPdfOut ? "none" : "flex";

    // Messages about format
    if(hasAny && !busy){
      if(selFormat.value === "image/png") setMessage(t.msg_png_q, "");
      else if(selFormat.value === "application/pdf") setMessage(t.msg_pdf_q, "");
      else setMessage(t.msg_ready(files.length), "ok");
    }

    listWrap.style.display = hasAny ? "block" : "none";
  }

  function renderFileList(){
    fileListEl.innerHTML = "";
    if(files.length === 0) return;

    files.forEach((it, idx)=>{
      const row = document.createElement("div");
      row.className = "fileItem";

      const left = document.createElement("div");
      left.className = "fileLeft";

      const thumbBox = document.createElement("div");
      thumbBox.className = "miniThumb";

      if(it.kind === "image" && it._thumbUrl){
        const im = document.createElement("img");
        im.src = it._thumbUrl;
        thumbBox.appendChild(im);
      } else {
        const icon = document.createElement("div");
        icon.className = "miniIcon";
        icon.textContent = (it.kind === "pdf") ? "ğŸ“„" : "ğŸ–¼ï¸";
        thumbBox.appendChild(icon);
      }

      const text = document.createElement("div");
      text.className = "fileText";

      const name = document.createElement("div");
      name.className = "fileName";
      name.textContent = `${idx+1}. ${it.name}`;

      const sub = document.createElement("div");
      sub.className = "fileSub";
      const lockTag = (it.kind==="pdf" && it.lockedPdf) ? " ğŸ”’" : "";
      const pagesTag = (it.kind==="pdf" && typeof it.pdfPages==="number") ? ` Â· ${it.pdfPages}p` : "";
      sub.textContent = `${it.type || "unknown"} Â· ${humanSize(it.size)}${pagesTag}${lockTag}`;

      text.appendChild(name);
      text.appendChild(sub);

      left.appendChild(thumbBox);
      left.appendChild(text);

      const btns = document.createElement("div");
      btns.className = "fileBtns";

      const up = document.createElement("button");
      up.className = "iconBtn";
      up.type = "button";
      up.textContent = "â†‘";
      up.disabled = idx === 0;
      up.addEventListener("click", ()=>{
        moveItem(idx, idx-1);
      });

      const down = document.createElement("button");
      down.className = "iconBtn";
      down.type = "button";
      down.textContent = "â†“";
      down.disabled = idx === files.length-1;
      down.addEventListener("click", ()=>{
        moveItem(idx, idx+1);
      });

      const del = document.createElement("button");
      del.className = "iconBtn";
      del.type = "button";
      del.textContent = "ğŸ—‘";
      del.addEventListener("click", ()=>{
        removeItem(idx);
      });

      btns.appendChild(up);
      btns.appendChild(down);
      btns.appendChild(del);

      row.appendChild(left);
      row.appendChild(btns);

      // click row => set preview
      row.addEventListener("click", (e)=>{
        // avoid when clicking buttons
        if(e.target && (e.target.closest(".iconBtn"))) return;
        currentIndex = idx;
        renderPreviewMeta();
      });

      fileListEl.appendChild(row);
    });
  }

  function moveItem(from, to){
    if(to<0 || to>=files.length) return;
    const temp = files[from];
    files.splice(from,1);
    files.splice(to,0,temp);
    // adjust current preview
    if(currentIndex === from) currentIndex = to;
    else if(currentIndex === to) currentIndex = from;
    renderFileList();
    renderPreviewMeta();
  }

  function removeItem(idx){
    const it = files[idx];
    // cleanup thumb url
    if(it && it._thumbUrl){
      try{ URL.revokeObjectURL(it._thumbUrl); }catch(e){}
    }
    files.splice(idx,1);
    if(currentIndex >= files.length) currentIndex = Math.max(0, files.length-1);
    renderFileList();
    renderPreviewMeta();
    refreshUIState();
    if(files.length === 0) setMessage("", "");
  }

  function renderPreviewMeta(){
    const t = STR[LANG];
    if(files.length === 0){
      meta.textContent = t.meta_idle;
      thumb.innerHTML = `<span style="color:#90a3c1; font-size:12px;">${t.thumb_label}</span>`;
      return;
    }
    const it = files[currentIndex] || files[0];
    if(!it) return;

    // preview thumb
    if(it.kind === "image" && it._thumbUrl){
      thumb.innerHTML = "";
      const im = document.createElement("img");
      im.src = it._thumbUrl;
      im.alt = it.name;
      thumb.appendChild(im);
    } else {
      thumb.innerHTML = `<div style="font-size:34px; opacity:.9;">${it.kind==="pdf"?"ğŸ“„":"ğŸ–¼ï¸"}</div>`;
    }

    // meta
    let extra = "";
    if(it.kind === "image" && it.imgW && it.imgH){
      extra = t.extra_img(it.imgW, it.imgH);
    } else if(it.kind === "pdf"){
      if(typeof it.pdfPages === "number") extra = t.extra_pdf(it.pdfPages);
      if(it.lockedPdf){
        extra = (extra ? (extra+"<br/>") : "") + `<span style="color:#ffd5a6; font-weight:800;">ğŸ”’ Locked / Restricted PDF</span>`;
      }
    }
    meta.innerHTML = t.meta_tpl(
      escapeHtml(it.name),
      escapeHtml(it.type || "unknown"),
      humanSize(it.size),
      extra
    );
  }

  // ===== File loading =====
  async function readPdfPagesOrLock(file){
    // returns {pages:number|null, locked:boolean}
    try{
      const bytes = new Uint8Array(await file.arrayBuffer());
      const pdfDoc = await PDFLib.PDFDocument.load(bytes, { ignoreEncryption: false });
      return { pages: pdfDoc.getPageCount(), locked:false };
    }catch(e){
      // Many encrypted/permission PDFs throw here.
      return { pages:null, locked:true };
    }
  }

  async function loadImageInfo(file){
    return new Promise((resolve, reject)=>{
      const url = URL.createObjectURL(file);
      const img = new Image();
      img.onload = ()=>{
        const w = img.naturalWidth, h = img.naturalHeight;
        URL.revokeObjectURL(url);
        resolve({ w, h });
      };
      img.onerror = ()=>{
        URL.revokeObjectURL(url);
        reject(new Error("img load error"));
      };
      img.src = url;
    });
  }

  async function addFiles(fileList){
    const t = STR[LANG];
    const arr = Array.from(fileList || []);
    if(arr.length === 0) return;

    setMessage(t.msg_loading, "");
    busy = true;
    refreshUIState();

    for(const f of arr){
      const isImg = (f.type || "").startsWith("image/");
      const isPdf = (f.type || "") === "application/pdf" || (f.name || "").toLowerCase().endsWith(".pdf");

      if(!isImg && !isPdf){
        setMessage(t.err_only_img_pdf, "err");
        continue;
      }

      const id = cryptoRandomId();
      const item = {
        id,
        file: f,
        kind: isPdf ? "pdf" : "image",
        name: f.name || "file",
        type: f.type || (isPdf ? "application/pdf" : "image/*"),
        size: f.size || 0,
        imgW: null,
        imgH: null,
        pdfPages: null,
        lockedPdf: false,
        _thumbUrl: null
      };

      try{
        if(item.kind === "image"){
          // create thumb URL and size
          item._thumbUrl = URL.createObjectURL(f);
          const info = await loadImageInfo(f);
          item.imgW = info.w; item.imgH = info.h;
        } else {
          // PDF: try read pages
          const res = await readPdfPagesOrLock(f);
          item.lockedPdf = res.locked;
          item.pdfPages = res.pages;
          // no thumb
        }
        files.push(item);
      }catch(e){
        setMessage(t.err_process, "err");
      }
    }

    if(files.length > 0){
      currentIndex = 0;
      setMessage(t.msg_ready(files.length), "ok");
    } else {
      setMessage("", "");
    }

    busy = false;
    renderFileList();
    renderPreviewMeta();
    refreshUIState();
  }

  function cryptoRandomId(){
    try{
      const a = new Uint8Array(8);
      crypto.getRandomValues(a);
      return Array.from(a).map(b=>b.toString(16).padStart(2,"0")).join("");
    }catch(e){
      return String(Math.random()).slice(2);
    }
  }

  function resetAll(){
    // cleanup URLs
    files.forEach(it=>{
      if(it._thumbUrl){
        try{ URL.revokeObjectURL(it._thumbUrl); }catch(e){}
      }
    });
    files = [];
    currentIndex = 0;
    fileInput.value = "";
    inW.value = "";
    inH.value = "";
    setMessage("", "");
    renderTexts();
    renderFileList();
    renderPreviewMeta();
    refreshUIState();
  }

  // ===== Conversion helpers =====
  function getTargetSizeForImage(it){
    const wIn = parseInt(inW.value,10);
    const hIn = parseInt(inH.value,10);
    const ow = it.imgW || 0, oh = it.imgH || 0;

    if(!wIn && !hIn) return { w: ow, h: oh };
    if(wIn && !hIn) return { w: wIn, h: Math.round(wIn * (oh/ow)) };
    if(!wIn && hIn) return { w: Math.round(hIn * (ow/oh)), h: hIn };
    return { w: wIn, h: hIn };
  }

  async function imageToBlob(it, outMime, quality){
    const { w, h } = getTargetSizeForImage(it);
    const bmp = await createImageBitmap(it.file);
    const canvas = document.createElement("canvas");
    canvas.width = w; canvas.height = h;
    const ctx = canvas.getContext("2d", { alpha:true });
    ctx.imageSmoothingEnabled = true;
    ctx.imageSmoothingQuality = "high";
    ctx.drawImage(bmp, 0, 0, w, h);

    return await new Promise((resolve)=>{
      if(outMime === "image/png"){
        canvas.toBlob(resolve, outMime);
      } else {
        canvas.toBlob(resolve, outMime, quality);
      }
    });
  }

  // A4 sizes in points
  const A4_P = { w: 595.28, h: 841.89 };
  const A4_L = { w: 841.89, h: 595.28 };

  function calcFitFill(srcW, srcH, dstW, dstH, mode){
    const scaleFit = Math.min(dstW/srcW, dstH/srcH);
    const scaleFill = Math.max(dstW/srcW, dstH/srcH);
    const s = (mode === "fill") ? scaleFill : scaleFit;
    const w = srcW * s;
    const h = srcH * s;
    const x = (dstW - w) / 2;
    const y = (dstH - h) / 2;
    return { x, y, w, h };
  }

  async function buildMergedPdf(mode){
    // mode: 'single' | 'images_merge' | 'pdf_merge' | 'mixed_merge'
    const t = STR[LANG];
    const outDoc = await PDFLib.PDFDocument.create();

    const normalize = !!a4On.checked;
    const orient = a4Orient.value; // portrait|landscape
    const fitMode = a4Fit.value; // fit|fill
    const a4 = (orient === "landscape") ? A4_L : A4_P;

    const skipLocked = (pdfSkipLocked.value === "1");

    // helpers to add page with A4 normalization
    function addA4PageWithEmbeddedPage(embed, srcW, srcH){
      const page = outDoc.addPage([a4.w, a4.h]);
      const r = calcFitFill(srcW, srcH, a4.w, a4.h, fitMode);
      page.drawPage(embed, { x:r.x, y:r.y, width:r.w, height:r.h });
    }
    function addA4PageWithImage(imgEmbed, srcW, srcH){
      const page = outDoc.addPage([a4.w, a4.h]);
      const r = calcFitFill(srcW, srcH, a4.w, a4.h, fitMode);
      page.drawImage(imgEmbed, { x:r.x, y:r.y, width:r.w, height:r.h });
    }

    // select source items
    const images = files.filter(f=>f.kind==="image");
    const pdfs   = files.filter(f=>f.kind==="pdf");

    if(mode === "single"){
      // first file only -> one page PDF
      const first = files[0];
      if(!first) throw new Error("none");
      if(first.kind === "image"){
        const bytes = new Uint8Array(await first.file.arrayBuffer());
        // embed as png/jpg based on original (png recommended for reliability)
        let img;
        const mime = (first.type || "").toLowerCase();
        if(mime.includes("jpeg") || mime.includes("jpg")){
          img = await outDoc.embedJpg(bytes);
        } else {
          // most formats -> convert to PNG via canvas for stable embed
          const pngBlob = await imageToBlob(first, "image/png", 0.92);
          const pngBytes = new Uint8Array(await pngBlob.arrayBuffer());
          img = await outDoc.embedPng(pngBytes);
        }
        const pw = img.width, ph = img.height;
        if(normalize){
          addA4PageWithImage(img, pw, ph);
        } else {
          const page = outDoc.addPage([pw, ph]);
          page.drawImage(img, { x:0, y:0, width:pw, height:ph });
        }
      } else {
        // first is pdf
        const bytes = new Uint8Array(await first.file.arrayBuffer());
        try{
          const src = await PDFLib.PDFDocument.load(bytes, { ignoreEncryption:false });
          const [p0] = await outDoc.copyPages(src, [0]);
          if(normalize){
            // embed first page into A4
            const embedded = await outDoc.embedPage(p0);
            const { width, height } = p0.getSize();
            addA4PageWithEmbeddedPage(embedded, width, height);
          } else {
            outDoc.addPage(p0);
          }
        }catch(e){
          setMessage(t.warn_pdf_locked(first.name), "warn");
          throw e;
        }
      }
      return outDoc;
    }

    if(mode === "images_merge"){
      if(images.length === 0) throw new Error("no images");
      for(const it of files){
        if(it.kind !== "image") continue;

        // convert to PNG (stable)
        const pngBlob = await imageToBlob(it, "image/png", 0.92);
        const pngBytes = new Uint8Array(await pngBlob.arrayBuffer());
        const img = await outDoc.embedPng(pngBytes);

        const pw = img.width, ph = img.height;
        if(normalize){
          addA4PageWithImage(img, pw, ph);
        } else {
          const page = outDoc.addPage([pw, ph]);
          page.drawImage(img, { x:0, y:0, width:pw, height:ph });
        }
      }
      return outDoc;
    }

    if(mode === "pdf_merge"){
      if(pdfs.length === 0) throw new Error("no pdfs");
      for(const it of files){
        if(it.kind !== "pdf") continue;

        const bytes = new Uint8Array(await it.file.arrayBuffer());
        let src;
        try{
          src = await PDFLib.PDFDocument.load(bytes, { ignoreEncryption:false });
        }catch(e){
          // locked
          if(skipLocked){
            setMessage(t.warn_pdf_skip(it.name), "warn");
            continue;
          } else {
            setMessage(t.warn_pdf_locked(it.name), "warn");
            throw e;
          }
        }

        const pageCount = src.getPageCount();
        const idxs = Array.from({length:pageCount}, (_,i)=>i);
        const copied = await outDoc.copyPages(src, idxs);

        if(normalize){
          // embed each copied page onto A4
          for(const p of copied){
            const embedded = await outDoc.embedPage(p);
            const { width, height } = p.getSize();
            addA4PageWithEmbeddedPage(embedded, width, height);
          }
        } else {
          copied.forEach(p=> outDoc.addPage(p));
        }
      }
      return outDoc;
    }

    // mixed_merge: images + pdfs in chosen order
    for(const it of files){
      if(it.kind === "image"){
        const pngBlob = await imageToBlob(it, "image/png", 0.92);
        const pngBytes = new Uint8Array(await pngBlob.arrayBuffer());
        const img = await outDoc.embedPng(pngBytes);
        const pw = img.width, ph = img.height;
        if(normalize){
          addA4PageWithImage(img, pw, ph);
        } else {
          const page = outDoc.addPage([pw, ph]);
          page.drawImage(img, { x:0, y:0, width:pw, height:ph });
        }
      } else if(it.kind === "pdf"){
        const bytes = new Uint8Array(await it.file.arrayBuffer());
        let src;
        try{
          src = await PDFLib.PDFDocument.load(bytes, { ignoreEncryption:false });
        }catch(e){
          if(skipLocked){
            setMessage(t.warn_pdf_skip(it.name), "warn");
            continue;
          } else {
            setMessage(t.warn_pdf_locked(it.name), "warn");
            throw e;
          }
        }
        const pageCount = src.getPageCount();
        const idxs = Array.from({length:pageCount}, (_,i)=>i);
        const copied = await outDoc.copyPages(src, idxs);

        if(normalize){
          for(const p of copied){
            const embedded = await outDoc.embedPage(p);
            const { width, height } = p.getSize();
            addA4PageWithEmbeddedPage(embedded, width, height);
          }
        } else {
          copied.forEach(p=> outDoc.addPage(p));
        }
      }
    }
    return outDoc;
  }

  async function convertAndDownload(){
    const t = STR[LANG];
    if(files.length === 0){
      setMessage(t.err_none, "err");
      return;
    }

    busy = true;
    refreshUIState();
    setMessage(t.converting, "");

    try{
      const outMime = selFormat.value;
      const quality = parseFloat(selQuality.value);

      // ===== PDF output =====
      if(outMime === "application/pdf"){
        // ensure mode labels stay localized
        // Build merged PDF by mode
        const mode = pdfMode.value;

        // safety: for images_merge, require at least 1 image
        if(mode === "images_merge" && !files.some(f=>f.kind==="image")){
          throw new Error("no images");
        }
        if(mode === "pdf_merge" && !files.some(f=>f.kind==="pdf")){
          throw new Error("no pdf");
        }

        const pdfDoc = await buildMergedPdf(mode);
        const pdfBytes = await pdfDoc.save();
        const blob = new Blob([pdfBytes], { type:"application/pdf" });

        const name = `convertfiles24_${nowStamp()}.pdf`;
        downloadBlob(blob, name);
        setMessage(t.ok_done(name), "ok");

        busy = false;
        refreshUIState();
        return;
      }

      // ===== Image output (JPG/PNG/WebP) =====
      const imgItems = files.filter(f=>f.kind==="image");

      if(imgItems.length === 0){
        throw new Error("no images");
      }

      // if multiple images selected:
      if(imgItems.length > 1 && !zipOn.checked){
        // Convert only first image, and warn about ZIP
        setMessage(t.warn_multi_zip, "warn");
      }

      if(imgItems.length > 1 && zipOn.checked){
        // Convert all images and zip
        const zip = new JSZip();
        for(const it of imgItems){
          const blob = await imageToBlob(it, outMime, quality);
          if(!blob) throw new Error("blob null");
          const ext = mimeToExt(outMime);
          const outName = `${baseName(it.name)}_${nowStamp()}.${ext}`;
          zip.file(outName, blob);
        }
        const zipBlob = await zip.generateAsync({ type:"blob" });
        const zipName = `convertfiles24_${nowStamp()}.zip`;
        downloadBlob(zipBlob, zipName);
        setMessage(t.ok_zip_done(zipName), "ok");
      } else {
        // Convert first image only
        const it = imgItems[0];
        const blob = await imageToBlob(it, outMime, quality);
        if(!blob) throw new Error("blob null");
        const ext = mimeToExt(outMime);
        const outName = `${baseName(it.name)}_${nowStamp()}.${ext}`;
        downloadBlob(blob, outName);
        setMessage(t.ok_done(outName), "ok");
      }

    }catch(e){
      setMessage(STR[LANG].err_convert, "err");
    } finally {
      busy = false;
      refreshUIState();
    }
  }

  // ===== Events =====
  // Mobile file picker trigger ê°•í™”
  pickBtn.addEventListener("click", ()=>{
    try{
      fileInput.value = ""; // allow selecting same files again
      fileInput.click();
    }catch(e){}
  });

  // Drag & drop
  ["dragenter","dragover"].forEach(evt => {
    drop.addEventListener(evt, (e) => {
      e.preventDefault();
      e.stopPropagation();
      drop.classList.add("drag");
    });
  });
  ["dragleave","drop"].forEach(evt => {
    drop.addEventListener(evt, (e) => {
      e.preventDefault();
      e.stopPropagation();
      drop.classList.remove("drag");
    });
  });
  drop.addEventListener("drop", async (e) => {
    const list = e.dataTransfer.files;
    if(list && list.length) await addFiles(list);
  });

  fileInput.addEventListener("change", async (e)=>{
    const list = e.target.files;
    if(list && list.length) await addFiles(list);
  });

  btnConvert.addEventListener("click", convertAndDownload);
  btnReset.addEventListener("click", resetAll);

  selFormat.addEventListener("change", ()=>{
    refreshUIState();
  });

  // ===== init =====
  setActiveLangButtons(LANG);
  renderTexts();
  refreshUIState();
  renderFileList();
  renderPreviewMeta();
  setLang(LANG);
})();
</script>
</body>
</html>